{
  "patches": {
    "@/main": {
      "links": {
        "rknZCkqBu": {
          "id": "rknZCkqBu",
          "output": {
            "nodeId": "ry31c19Bu",
            "pinKey": "BJ--G1tI-"
          },
          "input": {
            "nodeId": "HJcA6y9ru",
            "pinKey": "HJAq-A_8-"
          }
        },
        "HkgqsZcSO": {
          "id": "HkgqsZcSO",
          "output": {
            "nodeId": "r16Psb5S_",
            "pinKey": "rksccsp-W"
          },
          "input": {
            "nodeId": "ByAikRtr_",
            "pinKey": "rJgnw0417B"
          }
        },
        "SygtCWcr_": {
          "id": "SygtCWcr_",
          "output": {
            "nodeId": "SJ-u0Zcru",
            "pinKey": "r1H_oipZb"
          },
          "input": {
            "nodeId": "r16Psb5S_",
            "pinKey": "BkeKcj6ZZ"
          }
        },
        "S1axeM5Hd": {
          "id": "S1axeM5Hd",
          "output": {
            "nodeId": "SJI8pAtSd",
            "pinKey": "BJkDP8GEM"
          },
          "input": {
            "nodeId": "r1R0JfcBO",
            "pinKey": "Skd9Qa_8W"
          }
        },
        "By8ezfqB_": {
          "id": "By8ezfqB_",
          "output": {
            "nodeId": "rkT-nb9SO",
            "pinKey": "rksccsp-W"
          },
          "input": {
            "nodeId": "ByAikRtr_",
            "pinKey": "BJ3DAE1QS"
          }
        },
        "H1h6GMcB_": {
          "id": "H1h6GMcB_",
          "output": {
            "nodeId": "B1asMMqSu",
            "pinKey": "S13xLCuHvkW"
          },
          "input": {
            "nodeId": "rkT-nb9SO",
            "pinKey": "BkeKcj6ZZ-$2"
          }
        },
        "r17_NG5rd": {
          "id": "r17_NG5rd",
          "output": {
            "nodeId": "H1s1lGqB_",
            "pinKey": "S13xLCuHvkW"
          },
          "input": {
            "nodeId": "Sy37ZMqBu",
            "pinKey": "BJlHojaWZ"
          }
        },
        "H1BdEzqrO": {
          "id": "H1BdEzqrO",
          "output": {
            "nodeId": "Sy37ZMqBu",
            "pinKey": "r1H_oipZb"
          },
          "input": {
            "nodeId": "rkT-nb9SO",
            "pinKey": "BkeKcj6ZZ"
          }
        },
        "H1DY4z9Bu": {
          "id": "H1DY4z9Bu",
          "output": {
            "nodeId": "SJI8pAtSd",
            "pinKey": "BJkDP8GEM"
          },
          "input": {
            "nodeId": "H1s1lGqB_",
            "pinKey": "r1AgIROHDJW"
          }
        },
        "Sk9tEM5Bu": {
          "id": "Sk9tEM5Bu",
          "output": {
            "nodeId": "r1R0JfcBO",
            "pinKey": "H1kiQaO8W"
          },
          "input": {
            "nodeId": "H1s1lGqB_",
            "pinKey": "ryTeUROHD1b"
          }
        },
        "HJnRVz5Bd": {
          "id": "HJnRVz5Bd",
          "output": {
            "nodeId": "Bk9nyG5S_",
            "pinKey": "BJ--G1tI-"
          },
          "input": {
            "nodeId": "B1h2NfqHd",
            "pinKey": "ryTIROHwkW"
          }
        },
        "S1xzSGqBO": {
          "id": "S1xzSGqBO",
          "output": {
            "nodeId": "B1h2NfqHd",
            "pinKey": "HkyxURuSPyW"
          },
          "input": {
            "nodeId": "H1s1lGqB_",
            "pinKey": "S1yZIA_rDJZ"
          }
        },
        "r1siLMcSd": {
          "id": "r1siLMcSd",
          "output": {
            "nodeId": "B1h2NfqHd",
            "pinKey": "HkyxURuSPyW"
          },
          "input": {
            "nodeId": "B1asMMqSu",
            "pinKey": "S1yZIA_rDJZ"
          }
        },
        "B1gFpz9Hd": {
          "id": "B1gFpz9Hd",
          "output": {
            "nodeId": "HJcA6y9ru",
            "pinKey": "r1yhZRd8W"
          },
          "input": {
            "nodeId": "ryp_TfcHd",
            "pinKey": "HkXK-dGob"
          }
        },
        "BkUKafqSd": {
          "id": "BkUKafqSd",
          "output": {
            "nodeId": "HJj2sz9Bd",
            "pinKey": "BkqLCOSw1W"
          },
          "input": {
            "nodeId": "ryGtpG5SO",
            "pinKey": "HkXK-dGob"
          }
        },
        "BkOVkmqS_": {
          "id": "BkOVkmqS_",
          "output": {
            "nodeId": "HJj2sz9Bd",
            "pinKey": "BkqLCOSw1W"
          },
          "input": {
            "nodeId": "BJyNy75r_",
            "pinKey": "B1GfLR_SPk-"
          }
        },
        "BkbrkmqB_": {
          "id": "BkbrkmqB_",
          "output": {
            "nodeId": "BJyNy75r_",
            "pinKey": "BkQzLCurwJZ"
          },
          "input": {
            "nodeId": "SJ-u0Zcru",
            "pinKey": "BJlHojaWZ"
          }
        },
        "SkiY1m5Hu": {
          "id": "SkiY1m5Hu",
          "output": {
            "nodeId": "HJcA6y9ru",
            "pinKey": "r1yhZRd8W"
          },
          "input": {
            "nodeId": "HJj2sz9Bd",
            "pinKey": "SkdIRuBD1b"
          }
        },
        "Sy4PyNcSd": {
          "id": "Sy4PyNcSd",
          "output": {
            "nodeId": "SybnjmcBd",
            "pinKey": "B1jH-YVzB"
          },
          "input": {
            "nodeId": "HJcA6y9ru",
            "pinKey": "SkUjZA_L-"
          }
        },
        "B153eE5r_": {
          "id": "B153eE5r_",
          "output": {
            "nodeId": "S1ofgV5Bd",
            "pinKey": "ryVmUAOrvkb"
          },
          "input": {
            "nodeId": "rJGig45rd",
            "pinKey": "HJAq-A_8-"
          }
        },
        "rJ1ClV5SO": {
          "id": "rJ1ClV5SO",
          "output": {
            "nodeId": "rJGig45rd",
            "pinKey": "r1yhZRd8W"
          },
          "input": {
            "nodeId": "B19axNcrO",
            "pinKey": "HkXK-dGob"
          }
        },
        "Hkk6GN9SO": {
          "id": "Hkk6GN9SO",
          "output": {
            "nodeId": "SyJm2mcSu",
            "pinKey": "BJ--G1tI-"
          },
          "input": {
            "nodeId": "rJGig45rd",
            "pinKey": "SkUjZA_L-"
          }
        },
        "HkHMEV5Hd": {
          "id": "HkHMEV5Hd",
          "output": {
            "nodeId": "rJGig45rd",
            "pinKey": "r1yhZRd8W"
          },
          "input": {
            "nodeId": "BJ6WNE5S_",
            "pinKey": "rJXICuSwyW"
          }
        },
        "rkgcEEcH_": {
          "id": "rkgcEEcH_",
          "output": {
            "nodeId": "BJ6WNE5S_",
            "pinKey": "H1E8AuSPkZ"
          },
          "input": {
            "nodeId": "BkjYEEcHu",
            "pinKey": "S1yZIA_rDJZ"
          }
        },
        "S1eiNV5HO": {
          "id": "S1eiNV5HO",
          "output": {
            "nodeId": "BkjYEEcHu",
            "pinKey": "S13xLCuHvkW"
          },
          "input": {
            "nodeId": "SybnjmcBd",
            "pinKey": "SkgXWK4MB"
          }
        },
        "SyLjrVqr_": {
          "id": "SyLjrVqr_",
          "output": {
            "nodeId": "BJ6WNE5S_",
            "pinKey": "H1E8AuSPkZ"
          },
          "input": {
            "nodeId": "SJgjBE9BO",
            "pinKey": "HkXK-dGob"
          }
        },
        "Byssr49Hd": {
          "id": "Byssr49Hd",
          "output": {
            "nodeId": "BkjYEEcHu",
            "pinKey": "S13xLCuHvkW"
          },
          "input": {
            "nodeId": "H1morN5H_",
            "pinKey": "HkXK-dGob"
          }
        },
        "SJ_Y_MjB_": {
          "id": "SJ_Y_MjB_",
          "output": {
            "nodeId": "BJyNy75r_",
            "pinKey": "BkQzLCurwJZ"
          },
          "input": {
            "nodeId": "H13Q_zsH_",
            "pinKey": "rJXICuSwyW"
          }
        },
        "SyRKOziSu": {
          "id": "SyRKOziSu",
          "output": {
            "nodeId": "H13Q_zsH_",
            "pinKey": "H1E8AuSPkZ"
          },
          "input": {
            "nodeId": "HJAFPMiSd",
            "pinKey": "S1yZIA_rDJZ"
          }
        },
        "HkH9dzorO": {
          "id": "HkH9dzorO",
          "output": {
            "nodeId": "HJAFPMiSd",
            "pinKey": "S13xLCuHvkW"
          },
          "input": {
            "nodeId": "r179OMsH_",
            "pinKey": "HkXK-dGob"
          }
        }
      },
      "nodes": {
        "ByAikRtr_": {
          "boundLiterals": {
            "BJ3DAE1QS": "\"123\"",
            "rJgnw0417B": "\"temp\"",
            "Skb2DR4JQS": "True",
            "rkedCVkXS": "27h"
          },
          "id": "ByAikRtr_",
          "type": "xod-dev/text-lcd/text-lcd-i2c-16x2",
          "position": {
            "x": 15,
            "y": 8,
            "units": "slots"
          }
        },
        "SJI8pAtSd": {
          "boundLiterals": {
            "B1VSPLfEG": "D2"
          },
          "id": "SJI8pAtSd",
          "type": "xod/common-hardware/ds18b20-thermometer",
          "position": {
            "x": 16,
            "y": 4,
            "units": "slots"
          }
        },
        "ry31c19Bu": {
          "boundLiterals": {
            "ByNiWkt8Z": "D3"
          },
          "id": "ry31c19Bu",
          "type": "xod/common-hardware/button",
          "position": {
            "x": 23,
            "y": 4,
            "units": "slots"
          }
        },
        "HJcA6y9ru": {
          "id": "HJcA6y9ru",
          "type": "xod/core/count",
          "position": {
            "x": 22,
            "y": 5,
            "units": "slots"
          }
        },
        "r16Psb5S_": {
          "boundLiterals": {
            "Hkqu9oaWb": "\"oborot: \"",
            "BkeKcj6ZZ-$1": "\" %\""
          },
          "arityLevel": 2,
          "id": "r16Psb5S_",
          "type": "xod/core/concat",
          "position": {
            "x": 18,
            "y": 6,
            "units": "slots"
          }
        },
        "rkT-nb9SO": {
          "boundLiterals": {
            "Hkqu9oaWb": "\"temp: \"",
            "BkeKcj6ZZ-$1": "\"\\xdf\"",
            "BkeKcj6ZZ-$2": "\"C\""
          },
          "arityLevel": 3,
          "id": "rkT-nb9SO",
          "type": "xod/core/concat",
          "position": {
            "x": 7,
            "y": 8,
            "units": "slots"
          }
        },
        "SJ-u0Zcru": {
          "boundLiterals": {
            "HJTIija-W": "0"
          },
          "id": "SJ-u0Zcru",
          "type": "xod/core/format-number",
          "position": {
            "x": 23,
            "y": 7,
            "units": "slots"
          }
        },
        "Bk9nyG5S_": {
          "boundLiterals": {
            "ByNiWkt8Z": "D4",
            "BJ--G1tI-": "False",
            "ByG3ZyKLW": "Continuously"
          },
          "id": "Bk9nyG5S_",
          "type": "xod/common-hardware/button",
          "position": {
            "x": 7,
            "y": 4,
            "units": "slots"
          }
        },
        "r1R0JfcBO": {
          "id": "r1R0JfcBO",
          "type": "xod/units/c-to-f",
          "position": {
            "x": 16,
            "y": 5,
            "units": "slots"
          }
        },
        "H1s1lGqB_": {
          "id": "H1s1lGqB_",
          "type": "xod/core/if-else",
          "position": {
            "x": 7,
            "y": 6,
            "units": "slots"
          }
        },
        "Sy37ZMqBu": {
          "boundLiterals": {
            "HJTIija-W": "1"
          },
          "id": "Sy37ZMqBu",
          "type": "xod/core/format-number",
          "position": {
            "x": 7,
            "y": 7,
            "units": "slots"
          }
        },
        "B1asMMqSu": {
          "boundLiterals": {
            "ryTeUROHD1b": "\"F\"",
            "r1AgIROHDJW": "\"C\""
          },
          "id": "B1asMMqSu",
          "type": "xod/core/if-else",
          "position": {
            "x": 11,
            "y": 6,
            "units": "slots"
          }
        },
        "B1h2NfqHd": {
          "id": "B1h2NfqHd",
          "type": "xod/core/flip-flop",
          "position": {
            "x": 7,
            "y": 5,
            "units": "slots"
          }
        },
        "HJj2sz9Bd": {
          "boundLiterals": {
            "BytUCdHD1-": "500",
            "SkdIRuBD1b": "500"
          },
          "id": "HJj2sz9Bd",
          "type": "xod/core/divide",
          "position": {
            "x": 28,
            "y": 6,
            "units": "slots"
          }
        },
        "ryp_TfcHd": {
          "id": "ryp_TfcHd",
          "type": "xod/debug/watch",
          "position": {
            "x": 22,
            "y": 6,
            "units": "slots"
          }
        },
        "ryGtpG5SO": {
          "id": "ryGtpG5SO",
          "type": "xod/debug/watch",
          "position": {
            "x": 31,
            "y": 7,
            "units": "slots"
          }
        },
        "BJyNy75r_": {
          "boundLiterals": {
            "SJ4zUC_BD1-": "100"
          },
          "id": "BJyNy75r_",
          "type": "xod/core/multiply",
          "position": {
            "x": 26,
            "y": 7,
            "units": "slots"
          }
        },
        "SybnjmcBd": {
          "boundLiterals": {
            "SJdzbYEzH": "D5",
            "HyAya54Gr": "True",
            "SkgXWK4MB": "True"
          },
          "id": "SybnjmcBd",
          "type": "xod/common-hardware/relay",
          "position": {
            "x": 28,
            "y": 5,
            "units": "slots"
          }
        },
        "SyJm2mcSu": {
          "boundLiterals": {
            "ByNiWkt8Z": "D7",
            "BJ--G1tI-": "False",
            "ByG3ZyKLW": "Continuously"
          },
          "id": "SyJm2mcSu",
          "type": "xod/common-hardware/button",
          "position": {
            "x": 36,
            "y": 1,
            "units": "slots"
          }
        },
        "S1ofgV5Bd": {
          "id": "S1ofgV5Bd",
          "type": "xod/core/boot",
          "position": {
            "x": 35,
            "y": 2,
            "units": "slots"
          }
        },
        "rJGig45rd": {
          "id": "rJGig45rd",
          "type": "xod/core/count",
          "position": {
            "x": 34,
            "y": 3,
            "units": "slots"
          }
        },
        "B19axNcrO": {
          "id": "B19axNcrO",
          "type": "xod/debug/watch",
          "position": {
            "x": 36,
            "y": 4,
            "units": "slots"
          }
        },
        "BJ6WNE5S_": {
          "boundLiterals": {
            "HJG8C_SPkb": "1"
          },
          "id": "BJ6WNE5S_",
          "type": "xod/core/equal",
          "position": {
            "x": 33,
            "y": 4,
            "units": "slots"
          }
        },
        "BkjYEEcHu": {
          "boundLiterals": {
            "ryTeUROHD1b": "0",
            "r1AgIROHDJW": "1"
          },
          "id": "BkjYEEcHu",
          "type": "xod/core/if-else",
          "position": {
            "x": 28,
            "y": 4,
            "units": "slots"
          }
        },
        "SJgjBE9BO": {
          "id": "SJgjBE9BO",
          "type": "xod/debug/watch",
          "position": {
            "x": 34,
            "y": 5,
            "units": "slots"
          }
        },
        "H1morN5H_": {
          "id": "H1morN5H_",
          "type": "xod/debug/watch",
          "position": {
            "x": 32,
            "y": 5,
            "units": "slots"
          }
        },
        "HJAFPMiSd": {
          "boundLiterals": {
            "ryTeUROHD1b": "0",
            "r1AgIROHDJW": "1"
          },
          "id": "HJAFPMiSd",
          "type": "xod/core/if-else",
          "position": {
            "x": 23,
            "y": 9,
            "units": "slots"
          }
        },
        "H13Q_zsH_": {
          "id": "H13Q_zsH_",
          "type": "xod/core/equal",
          "position": {
            "x": 23,
            "y": 8,
            "units": "slots"
          },
          "boundLiterals": {
            "HJG8C_SPkb": "50"
          }
        },
        "r179OMsH_": {
          "id": "r179OMsH_",
          "type": "xod/debug/watch",
          "position": {
            "x": 23,
            "y": 10,
            "units": "slots"
          }
        },
        "S1u8YNsSu": {
          "id": "S1u8YNsSu",
          "type": "xod/uart/uart",
          "position": {
            "x": 19,
            "y": 1,
            "units": "slots"
          },
          "boundLiterals": {
            "H1DwMu5bX": "9600"
          }
        },
        "BkU1c4sH_": {
          "id": "BkU1c4sH_",
          "type": "xod/debug/watch",
          "position": {
            "x": 19,
            "y": 3,
            "units": "slots"
          }
        },
        "rkYB5NorO": {
          "id": "rkYB5NorO",
          "type": "@/readline",
          "position": {
            "x": 19,
            "y": 2,
            "units": "slots"
          }
        }
      },
      "path": "@/main"
    },
    "@/readline": {
      "nodes": {
        "HyEH5EoS_": {
          "description": "Fires on a new accumulated line",
          "label": "DONE",
          "id": "HyEH5EoS_",
          "position": {
            "x": 3.05,
            "y": 1.75,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "HkeEBc4iHO": {
          "id": "HkeEBc4iHO",
          "position": {
            "x": 0.05,
            "y": 0.75,
            "units": "slots"
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "H1WNrcVsB_": {
          "description": "Empty the accumulated string line and start over",
          "label": "RST",
          "id": "H1WNrcVsB_",
          "position": {
            "x": 6.05,
            "y": -0.25,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "HyM4ScNoH_": {
          "description": "Push new character",
          "label": "PUSH",
          "id": "HyM4ScNoH_",
          "position": {
            "x": 3.05,
            "y": -0.25,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "BJXNBcViS_": {
          "description": "Accumulated line",
          "label": "LINE",
          "id": "BJXNBcViS_",
          "position": {
            "x": 0,
            "y": 1.75,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-string"
        },
        "SkVESq4iSu": {
          "description": "A new character to be pushed to the end of the string line",
          "label": "CHAR",
          "id": "SkVESq4iSu",
          "position": {
            "x": 0.05,
            "y": -0.25,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-byte"
        }
      },
      "path": "@/readline",
      "attachments": [
        {
          "filename": "patch.cpp",
          "encoding": "utf-8",
          "content": "\n/*\n * A list constructor based on double buffering technique. The front buffer\n * is immutable and read-only while an algorithm constructs a new list\n * behind the scenes using the back buffer.\n *\n * Once the back buffer is ready, the algorithm swaps the buffers and starts\n * over: now the buffer that used to be on back plays the role of front buffer\n * and vice versa.\n *\n * Use this class to accumulate some sparse stream of items into a list when\n * presenting an intermediate result to consumers is unacceptable, the\n * consumers will sDoubleBufferee the latest “published” result instead.\n *\n * `CAP` defines the maximal length of the list (in items). An instance of\n * double buffer consumes 2xCAP memory to hold two buffers at a time.\n */\n\ntemplate<size_t CAP>\nclass DoubleBuffer {\n  public:\n    DoubleBuffer()\n            : _active_buff0(false)\n    { }\n\n    void eraseBackBuffer(){\n        memset(backBuffer(), '\\0', CAP);\n    }\n\n    void swap(){\n        _active_buff0 = !_active_buff0;\n    }\n\n    char* backBuffer() {\n        return _active_buff0 ? _buff1 : _buff0;\n    }\n\n    const char* frontBuffer() const {\n        return _active_buff0 ? _buff0 : _buff1;\n    }\n\n  private:\n    char _buff0[CAP];\n    char _buff1[CAP];\n    bool _active_buff0;\n};\n\n\nstruct State {\n    char* cursor;\n    CStringView view;\n    DoubleBuffer<16> mbuf;\n};\n\n{{ GENERATED_CODE }}\n\nvoid evaluate(Context ctx) {\n    auto state = getState(ctx);\n\n    if (isSettingUp()) {\n        state->view = CStringView(state->mbuf.frontBuffer());\n    }\n    if (isInputDirty<input_RST>(ctx)){\n        state->mbuf.eraseBackBuffer();\n        state->cursor = state->mbuf.backBuffer();\n    }\n\n    if (isInputDirty<input_PUSH>(ctx)) {\n        if (getValue<input_CHAR>(ctx) == '\\n'){\n             state->mbuf.swap();\n            emitValue<output_LINE>(ctx, XString(&state->view));\n            emitValue<output_DONE>(ctx,1);\n        }\n        if (getValue<input_CHAR>(ctx) != '\\r'){\n            *state->cursor = getValue<input_CHAR>(ctx);\n            state->cursor++;\n        }\n    }\n}\n\n"
        }
      ]
    }
  },
  "name": "sollartrack"
}
