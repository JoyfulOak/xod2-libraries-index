{
  "patches": {
    "@/indoor-air-quality-sensor": {
      "nodes": {
        "r1oWlFHNa": {
          "id": "r1oWlFHNa",
          "type": "@/sgp30-device",
          "position": {
            "x": 2,
            "y": 0,
            "units": "slots"
          }
        },
        "Sk2zgKHVa": {
          "id": "Sk2zgKHVa",
          "type": "@/init",
          "position": {
            "x": 2,
            "y": 1,
            "units": "slots"
          }
        },
        "H1FQeYBNT": {
          "id": "H1FQeYBNT",
          "type": "@/measure-iaq",
          "position": {
            "x": 6,
            "y": 1,
            "units": "slots"
          }
        },
        "BkLCGYr4a": {
          "id": "BkLCGYr4a",
          "type": "@/measure-raw-iaq",
          "position": {
            "x": 9,
            "y": 1,
            "units": "slots"
          }
        },
        "SyhtQtSE6": {
          "id": "SyhtQtSE6",
          "type": "xod/i2c/input-i2c",
          "position": {
            "x": 3,
            "y": -1,
            "units": "slots"
          },
          "label": "I2C",
          "description": "I²C bus"
        },
        "B1zoQFHVa": {
          "id": "B1zoQFHVa",
          "type": "xod/patch-nodes/input-pulse",
          "position": {
            "x": 7,
            "y": -1,
            "units": "slots"
          },
          "label": "UPD",
          "description": "Update. Triggers measurement."
        },
        "B18oQKrEa": {
          "id": "B18oQKrEa",
          "type": "xod/patch-nodes/input-pulse",
          "position": {
            "x": 4,
            "y": -1,
            "units": "slots"
          },
          "label": "INIT",
          "description": "Initialize sensor.",
          "boundLiterals": {
            "__out__": "On Boot"
          }
        },
        "HJ7pXFSVa": {
          "id": "HJ7pXFSVa",
          "type": "xod/patch-nodes/to-bus",
          "position": {
            "x": 1,
            "y": 1,
            "units": "slots"
          },
          "label": "DEV"
        },
        "SkPRQYrN6": {
          "id": "SkPRQYrN6",
          "type": "xod/patch-nodes/from-bus",
          "position": {
            "x": 6,
            "y": 0,
            "units": "slots"
          },
          "label": "DEV"
        },
        "rJbJ4YHET": {
          "id": "rJbJ4YHET",
          "type": "xod/patch-nodes/from-bus",
          "position": {
            "x": 9,
            "y": 0,
            "units": "slots"
          },
          "label": "DEV"
        },
        "Bk7-NFHEa": {
          "id": "Bk7-NFHEa",
          "type": "xod/patch-nodes/output-number",
          "position": {
            "x": 6,
            "y": 2,
            "units": "slots"
          },
          "label": "CO2",
          "description": "CO2 (ppm)."
        },
        "BkgmbEKHET": {
          "id": "BkgmbEKHET",
          "type": "xod/patch-nodes/output-number",
          "position": {
            "x": 7,
            "y": 2,
            "units": "slots"
          },
          "label": "TVOC",
          "description": "Total volatile organic compounds (ppb)."
        },
        "Sy-XbVtS4p": {
          "id": "Sy-XbVtS4p",
          "type": "xod/patch-nodes/output-pulse",
          "position": {
            "x": 11,
            "y": 2,
            "units": "slots"
          },
          "label": "Done",
          "description": "Pulse when a measurement has completed successfully."
        },
        "H1A4EKHN6": {
          "id": "H1A4EKHN6",
          "type": "xod/patch-nodes/output-number",
          "position": {
            "x": 9,
            "y": 2,
            "units": "slots"
          },
          "label": "H2",
          "description": "Raw H2."
        },
        "BkgAE4tHNT": {
          "id": "BkgAE4tHNT",
          "type": "xod/patch-nodes/output-number",
          "position": {
            "x": 10,
            "y": 2,
            "units": "slots"
          },
          "label": "EtOH",
          "description": "Raw ethanol."
        },
        "rkloBFrN6": {
          "id": "rkloBFrN6",
          "type": "xod/core/flip-flop",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          }
        },
        "SkasStBVa": {
          "id": "SkasStBVa",
          "type": "xod/core/gate",
          "position": {
            "x": 7,
            "y": 0,
            "units": "slots"
          }
        },
        "SkihSFSEa": {
          "id": "SkihSFSEa",
          "type": "xod/patch-nodes/to-bus",
          "position": {
            "x": 2,
            "y": 3,
            "units": "slots"
          },
          "label": "init"
        },
        "S1vpBKBVT": {
          "id": "S1vpBKBVT",
          "type": "xod/patch-nodes/from-bus",
          "position": {
            "x": 8,
            "y": -1,
            "units": "slots"
          },
          "label": "init"
        }
      },
      "links": {
        "BkTGlKSV6": {
          "id": "BkTGlKSV6",
          "output": {
            "nodeId": "r1oWlFHNa",
            "pinKey": "ryDrq_HN6"
          },
          "input": {
            "nodeId": "Sk2zgKHVa",
            "pinKey": "ryHtq_SEa"
          }
        },
        "SJoRfYHEa": {
          "id": "SJoRfYHEa",
          "output": {
            "nodeId": "H1FQeYBNT",
            "pinKey": "Sk_vauSVp"
          },
          "input": {
            "nodeId": "BkLCGYr4a",
            "pinKey": "rybC2WFBVp"
          }
        },
        "rJf5mYrVa": {
          "id": "rJf5mYrVa",
          "output": {
            "nodeId": "SyhtQtSE6",
            "pinKey": "__out__"
          },
          "input": {
            "nodeId": "Sk2zgKHVa",
            "pinKey": "S1hYq_rN6"
          }
        },
        "H1J3XKSNp": {
          "id": "H1J3XKSNp",
          "output": {
            "nodeId": "B18oQKrEa",
            "pinKey": "__out__"
          },
          "input": {
            "nodeId": "Sk2zgKHVa",
            "pinKey": "HJS35OSEp"
          }
        },
        "HynamYSVa": {
          "id": "HynamYSVa",
          "output": {
            "nodeId": "r1oWlFHNa",
            "pinKey": "ryDrq_HN6"
          },
          "input": {
            "nodeId": "HJ7pXFSVa",
            "pinKey": "__in__"
          }
        },
        "ByIkEYSVp": {
          "id": "ByIkEYSVp",
          "output": {
            "nodeId": "rJbJ4YHET",
            "pinKey": "__out__"
          },
          "input": {
            "nodeId": "BkLCGYr4a",
            "pinKey": "HJxChbKrNT"
          }
        },
        "HkOkEKS4p": {
          "id": "HkOkEKS4p",
          "output": {
            "nodeId": "SkPRQYrN6",
            "pinKey": "__out__"
          },
          "input": {
            "nodeId": "H1FQeYBNT",
            "pinKey": "BJZQ6OHEa"
          }
        },
        "rJn-VKSNp": {
          "id": "rJn-VKSNp",
          "output": {
            "nodeId": "BkLCGYr4a",
            "pinKey": "By403btrNT"
          },
          "input": {
            "nodeId": "Sy-XbVtS4p",
            "pinKey": "__in__"
          }
        },
        "HyJfEKH4T": {
          "id": "HyJfEKH4T",
          "output": {
            "nodeId": "H1FQeYBNT",
            "pinKey": "rJK8TurN6"
          },
          "input": {
            "nodeId": "Bk7-NFHEa",
            "pinKey": "__in__"
          }
        },
        "BklG4tBNp": {
          "id": "BklG4tBNp",
          "output": {
            "nodeId": "H1FQeYBNT",
            "pinKey": "ByaLaOBN6"
          },
          "input": {
            "nodeId": "BkgmbEKHET",
            "pinKey": "__in__"
          }
        },
        "HJ7rEFB46": {
          "id": "HJ7rEFB46",
          "output": {
            "nodeId": "BkLCGYr4a",
            "pinKey": "H1f03-FHV6"
          },
          "input": {
            "nodeId": "H1A4EKHN6",
            "pinKey": "__in__"
          }
        },
        "ByESNYHVT": {
          "id": "ByESNYHVT",
          "output": {
            "nodeId": "BkLCGYr4a",
            "pinKey": "BymChZFSEp"
          },
          "input": {
            "nodeId": "BkgAE4tHNT",
            "pinKey": "__in__"
          }
        },
        "H1VsrFrNT": {
          "id": "H1VsrFrNT",
          "output": {
            "nodeId": "Sk2zgKHVa",
            "pinKey": "Sy4-o_SN6"
          },
          "input": {
            "nodeId": "rkloBFrN6",
            "pinKey": "Bkh8A_Sv1-"
          }
        },
        "By7nrFHEp": {
          "id": "By7nrFHEp",
          "output": {
            "nodeId": "B1zoQFHVa",
            "pinKey": "__out__"
          },
          "input": {
            "nodeId": "SkasStBVa",
            "pinKey": "SJ-1mZPTz"
          }
        },
        "BJShHtrEp": {
          "id": "BJShHtrEp",
          "output": {
            "nodeId": "SkasStBVa",
            "pinKey": "OkPg7GDaW"
          },
          "input": {
            "nodeId": "H1FQeYBNT",
            "pinKey": "BJENa_H4a"
          }
        },
        "HJy6SKBN6": {
          "id": "HJy6SKBN6",
          "output": {
            "nodeId": "rkloBFrN6",
            "pinKey": "HkyxURuSPyW"
          },
          "input": {
            "nodeId": "SkihSFSEa",
            "pinKey": "__in__"
          }
        },
        "HyoTBKHV6": {
          "id": "HyoTBKHV6",
          "output": {
            "nodeId": "S1vpBKBVT",
            "pinKey": "__out__"
          },
          "input": {
            "nodeId": "SkasStBVa",
            "pinKey": "B1P1nFwaM"
          }
        }
      },
      "path": "@/indoor-air-quality-sensor",
      "description": "Combines low level nodes to create a simple to use indoor air quality sensor."
    },
    "@/sgp30-device": {
      "nodes": {
        "B1_dSdrNT": {
          "id": "B1_dSdrNT",
          "type": "xod/patch-nodes/not-implemented-in-xod",
          "position": {
            "x": 2,
            "y": 1,
            "units": "slots"
          }
        },
        "ryDrq_HN6": {
          "id": "ryDrq_HN6",
          "type": "xod/patch-nodes/output-self",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          },
          "label": "DEV",
          "description": "An SGP30 device."
        }
      },
      "path": "@/sgp30-device",
      "description": "Create an SGP30 device.",
      "attachments": [
        {
          "filename": "patch.cpp",
          "encoding": "utf-8",
          "content": "// Tell XOD where it can download the libraries:\n#pragma XOD require \"https://github.com/adafruit/Adafruit_BusIO\"\n#pragma XOD require \"https://github.com/adafruit/Adafruit_Sensor\"\n#pragma XOD require \"https://github.com/adafruit/Adafruit_SGP30\"\n\n//Include C++ libraries\n#include <Adafruit_SGP30.h>\n\nnode {\n\n    meta {\n        // Define our custom type as a pointer on the class instance.\n        using Type = Adafruit_SGP30*;\n    }\n\n    // Keep Adafruit_SGP30 object in state\n    Adafruit_SGP30 sensor = Adafruit_SGP30();\n\n\n    void evaluate(Context ctx) {\n        // It should be evaluated only once on the first (setup) transaction\n        if (!isSettingUp())\n            return;\n        emitValue<output_DEV>(ctx, &sensor);\n    }\n}\n"
        }
      ]
    },
    "@/init": {
      "nodes": {
        "ryCdq_rVp": {
          "id": "ryCdq_rVp",
          "type": "xod/patch-nodes/not-implemented-in-xod",
          "position": {
            "x": 1,
            "y": 1,
            "units": "slots"
          }
        },
        "ryHtq_SEa": {
          "id": "ryHtq_SEa",
          "type": "@/input-sgp30-device",
          "position": {
            "x": 1,
            "y": 0,
            "units": "slots"
          },
          "label": "DEV",
          "description": "An SGP30 device."
        },
        "S1hYq_rN6": {
          "id": "S1hYq_rN6",
          "type": "xod/i2c/input-i2c",
          "position": {
            "x": 2,
            "y": 0,
            "units": "slots"
          },
          "label": "I2C",
          "description": "I²C bus"
        },
        "HJS35OSEp": {
          "id": "HJS35OSEp",
          "type": "xod/patch-nodes/input-pulse",
          "position": {
            "x": 3,
            "y": 0,
            "units": "slots"
          },
          "label": "INIT",
          "description": "Initialize",
          "boundLiterals": {
            "__out__": "On Boot"
          }
        },
        "Sy4-o_SN6": {
          "id": "Sy4-o_SN6",
          "type": "xod/patch-nodes/output-pulse",
          "position": {
            "x": 1,
            "y": 2,
            "units": "slots"
          },
          "label": "OK",
          "description": "Pulse on initialization."
        }
      },
      "path": "@/init",
      "attachments": [
        {
          "filename": "patch.cpp",
          "encoding": "utf-8",
          "content": "#pragma XOD evaluate_on_pin disable\n#pragma XOD evaluate_on_pin enable input_INIT\n\nnode {\n\n    void evaluate(Context ctx) {\n        // The node responds only if there is an input pulse\n        if (!isInputDirty<input_INIT>(ctx))\n            return;\n\n        auto sensor = getValue<input_DEV>(ctx);\n        auto wire = getValue<input_I2C>(ctx);\n\n        // Attempt to initialize sgp30 module; if attempt fails emit error\n        if (!sensor->begin(wire, true)) {\n            raiseError(ctx);\n            return;\n        }\n\n        emitValue<output_OK>(ctx, 1);\n\n    }\n}\n"
        }
      ]
    },
    "@/measure-iaq": {
      "nodes": {
        "BJ8z6drEp": {
          "id": "BJ8z6drEp",
          "type": "xod/patch-nodes/not-implemented-in-xod",
          "position": {
            "x": 2,
            "y": 1,
            "units": "slots"
          }
        },
        "BJZQ6OHEa": {
          "id": "BJZQ6OHEa",
          "type": "@/input-sgp30-device",
          "position": {
            "x": 2,
            "y": 0,
            "units": "slots"
          },
          "label": "DEV",
          "description": "An SGP30 device."
        },
        "BJENa_H4a": {
          "id": "BJENa_H4a",
          "type": "xod/patch-nodes/input-pulse",
          "position": {
            "x": 3,
            "y": 0,
            "units": "slots"
          },
          "label": "UPD",
          "description": "Update."
        },
        "rJK8TurN6": {
          "id": "rJK8TurN6",
          "type": "xod/patch-nodes/output-number",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          },
          "label": "CO2",
          "description": "CO2 (ppm)."
        },
        "ByaLaOBN6": {
          "id": "ByaLaOBN6",
          "type": "xod/patch-nodes/output-number",
          "position": {
            "x": 3,
            "y": 2,
            "units": "slots"
          },
          "label": "TVOC",
          "description": "Total volatile organic compounds (ppb)."
        },
        "Sk_vauSVp": {
          "id": "Sk_vauSVp",
          "type": "xod/patch-nodes/output-pulse",
          "position": {
            "x": 4,
            "y": 2,
            "units": "slots"
          },
          "label": "Done",
          "description": "Pulse when a measurement has completed successfully."
        }
      },
      "path": "@/measure-iaq",
      "description": "Take a single CO2/TVOC measurement.",
      "attachments": [
        {
          "filename": "patch.cpp",
          "encoding": "utf-8",
          "content": "#pragma XOD evaluate_on_pin disable\n#pragma XOD evaluate_on_pin enable input_UPD\n\nnode {\n\n    void evaluate(Context ctx) {\n        // The node responds only if there is an input pulse\n        if (!isInputDirty<input_UPD>(ctx))\n            return;\n\n        auto sensor = getValue<input_DEV>(ctx);\n\n        if (! sensor->IAQmeasure()) {\n            raiseError(ctx);\n            return;\n        }\n\n        emitValue<output_CO2>(ctx, sensor->eCO2);\n        emitValue<output_TVOC>(ctx, sensor->TVOC);\n        emitValue<output_Done>(ctx, 1);\n\n    }\n}\n"
        }
      ]
    },
    "@/measure-raw-iaq": {
      "nodes": {
        "ByCnZKHVp": {
          "id": "ByCnZKHVp",
          "type": "xod/patch-nodes/not-implemented-in-xod",
          "position": {
            "x": 0,
            "y": 1,
            "units": "slots"
          }
        },
        "HJxChbKrNT": {
          "id": "HJxChbKrNT",
          "type": "@/input-sgp30-device",
          "position": {
            "x": 0,
            "y": 0,
            "units": "slots"
          },
          "label": "DEV",
          "description": "An SGP30 device."
        },
        "rybC2WFBVp": {
          "id": "rybC2WFBVp",
          "type": "xod/patch-nodes/input-pulse",
          "position": {
            "x": 1,
            "y": 0,
            "units": "slots"
          },
          "label": "UPD",
          "description": "Update."
        },
        "H1f03-FHV6": {
          "id": "H1f03-FHV6",
          "type": "xod/patch-nodes/output-number",
          "position": {
            "x": 0,
            "y": 2,
            "units": "slots"
          },
          "label": "H2",
          "description": "Raw H2."
        },
        "BymChZFSEp": {
          "id": "BymChZFSEp",
          "type": "xod/patch-nodes/output-number",
          "position": {
            "x": 1,
            "y": 2,
            "units": "slots"
          },
          "label": "EtOH",
          "description": "Raw ethanol."
        },
        "By403btrNT": {
          "id": "By403btrNT",
          "type": "xod/patch-nodes/output-pulse",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          },
          "label": "Done",
          "description": "Pulse when a measurement has completed successfully."
        }
      },
      "path": "@/measure-raw-iaq",
      "description": "Take a single H2/ethanol raw measurement.",
      "attachments": [
        {
          "filename": "patch.cpp",
          "encoding": "utf-8",
          "content": "#pragma XOD evaluate_on_pin disable\n#pragma XOD evaluate_on_pin enable input_UPD\n\nnode {\n\n    void evaluate(Context ctx) {\n        // The node responds only if there is an input pulse\n        if (!isInputDirty<input_UPD>(ctx))\n            return;\n\n        auto sensor = getValue<input_DEV>(ctx);\n\n        if (! sensor->IAQmeasureRaw()) {\n            raiseError(ctx);\n            return;\n        }\n\n        emitValue<output_H2>(ctx, sensor->rawH2);\n        emitValue<output_EtOH>(ctx, sensor->rawEthanol);\n        emitValue<output_Done>(ctx, 1);\n\n    }\n}\n"
        }
      ]
    },
    "@/example-indoor-air-quality-sensor": {
      "nodes": {
        "HJ1HUYHNT": {
          "id": "HJ1HUYHNT",
          "type": "@/indoor-air-quality-sensor",
          "position": {
            "x": 4,
            "y": 2,
            "units": "slots"
          }
        },
        "rJrt8FBVp": {
          "id": "rJrt8FBVp",
          "type": "xod/core/clock",
          "position": {
            "x": 6,
            "y": 1,
            "units": "slots"
          }
        },
        "ry2YLtBN6": {
          "id": "ry2YLtBN6",
          "type": "xod/debug/watch",
          "position": {
            "x": 1,
            "y": 3,
            "units": "slots"
          },
          "size": {
            "width": 2,
            "height": 1,
            "units": "slots"
          }
        },
        "SyQ58FS46": {
          "id": "SyQ58FS46",
          "type": "xod/debug/watch",
          "position": {
            "x": 3,
            "y": 3,
            "units": "slots"
          },
          "size": {
            "width": 2,
            "height": 1,
            "units": "slots"
          }
        },
        "B13Qq8KSNa": {
          "id": "B13Qq8KSNa",
          "type": "xod/debug/watch",
          "position": {
            "x": 5,
            "y": 3,
            "units": "slots"
          },
          "size": {
            "width": 2,
            "height": 1,
            "units": "slots"
          }
        },
        "By49IKS4p": {
          "id": "By49IKS4p",
          "type": "xod/debug/watch",
          "position": {
            "x": 7,
            "y": 3,
            "units": "slots"
          },
          "size": {
            "width": 2,
            "height": 1,
            "units": "slots"
          }
        },
        "H1Mi8KB4p": {
          "id": "H1Mi8KB4p",
          "type": "xod/core/count",
          "position": {
            "x": 9,
            "y": 3,
            "units": "slots"
          }
        },
        "rJpoItrNp": {
          "id": "rJpoItrNp",
          "type": "xod/debug/watch",
          "position": {
            "x": 9,
            "y": 4,
            "units": "slots"
          }
        }
      },
      "links": {
        "BJ_tUYSVa": {
          "id": "BJ_tUYSVa",
          "output": {
            "nodeId": "rJrt8FBVp",
            "pinKey": "HJU8CE2lW"
          },
          "input": {
            "nodeId": "HJ1HUYHNT",
            "pinKey": "B1zoQFHVa"
          }
        },
        "rJLsLtH4T": {
          "id": "rJLsLtH4T",
          "output": {
            "nodeId": "HJ1HUYHNT",
            "pinKey": "Sy-XbVtS4p"
          },
          "input": {
            "nodeId": "H1Mi8KB4p",
            "pinKey": "HJAq-A_8-"
          }
        },
        "rygnIFBEa": {
          "id": "rygnIFBEa",
          "output": {
            "nodeId": "H1Mi8KB4p",
            "pinKey": "r1yhZRd8W"
          },
          "input": {
            "nodeId": "rJpoItrNp",
            "pinKey": "HkXK-dGob"
          }
        },
        "rkGh8FHNT": {
          "id": "rkGh8FHNT",
          "output": {
            "nodeId": "HJ1HUYHNT",
            "pinKey": "BkgAE4tHNT"
          },
          "input": {
            "nodeId": "By49IKS4p",
            "pinKey": "HkXK-dGob"
          }
        },
        "ByQ3IKHVp": {
          "id": "ByQ3IKHVp",
          "output": {
            "nodeId": "HJ1HUYHNT",
            "pinKey": "H1A4EKHN6"
          },
          "input": {
            "nodeId": "B13Qq8KSNa",
            "pinKey": "HkXK-dGob"
          }
        },
        "SkH28YrNa": {
          "id": "SkH28YrNa",
          "output": {
            "nodeId": "HJ1HUYHNT",
            "pinKey": "BkgmbEKHET"
          },
          "input": {
            "nodeId": "SyQ58FS46",
            "pinKey": "HkXK-dGob"
          }
        },
        "SkI3LFrVT": {
          "id": "SkI3LFrVT",
          "output": {
            "nodeId": "HJ1HUYHNT",
            "pinKey": "Bk7-NFHEa"
          },
          "input": {
            "nodeId": "ry2YLtBN6",
            "pinKey": "HkXK-dGob"
          }
        }
      },
      "path": "@/example-indoor-air-quality-sensor",
      "description": "Patch to test indoor-air-quality-sensor. Run in debugger."
    }
  },
  "license": "BSD",
  "version": "0.0.1",
  "description": "Sensirion SGP30 Indoor Air Quality (IAQ) sensor. Wraps https://github.com/adafruit/Adafruit_SGP30. Datasheet: https://sensirion.com/media/documents/984E0DD5/61644B8B/Sensirion_Gas_Sensors_Datasheet_SGP30.pdf.",
  "name": "sgp30"
}
