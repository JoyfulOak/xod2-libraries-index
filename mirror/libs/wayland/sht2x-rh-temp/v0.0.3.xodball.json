{
  "patches": {
    "@/example-hygrometer-thermometer": {
      "nodes": {
        "ByVgEdg0F": {
          "id": "ByVgEdg0F",
          "position": {
            "x": 6,
            "y": 1,
            "units": "slots"
          },
          "type": "@/hygrometer-thermometer"
        },
        "r1kQ4OgAY": {
          "id": "r1kQ4OgAY",
          "position": {
            "x": 6,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/debug/watch"
        },
        "By5QNueAY": {
          "id": "By5QNueAY",
          "position": {
            "x": 7,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/debug/watch"
        },
        "HJp74dl0K": {
          "id": "HJp74dl0K",
          "position": {
            "x": 8,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/debug/watch"
        },
        "HJzBNOxRt": {
          "id": "HJzBNOxRt",
          "position": {
            "x": 5,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/core/clock"
        },
        "SJXLNOxCF": {
          "id": "SJXLNOxCF",
          "position": {
            "x": 9,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/core/count"
        },
        "rJ9UEul0t": {
          "id": "rJ9UEul0t",
          "position": {
            "x": 12,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/core/count"
        },
        "BJKON_gRt": {
          "id": "BJKON_gRt",
          "position": {
            "x": 9,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/debug/tweak-pulse"
        },
        "SJVYVugCF": {
          "id": "SJVYVugCF",
          "position": {
            "x": 9,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/debug/watch"
        },
        "ryOtVdgAF": {
          "id": "ryOtVdgAF",
          "position": {
            "x": 12,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/debug/watch"
        }
      },
      "links": {
        "SywQVuxAF": {
          "id": "SywQVuxAF",
          "input": {
            "nodeId": "r1kQ4OgAY",
            "pinKey": "HkXK-dGob"
          },
          "output": {
            "nodeId": "ByVgEdg0F",
            "pinKey": "H1-CfOg0Y"
          }
        },
        "HJ2Q4OxRF": {
          "id": "HJ2Q4OxRF",
          "input": {
            "nodeId": "By5QNueAY",
            "pinKey": "HkXK-dGob"
          },
          "output": {
            "nodeId": "ByVgEdg0F",
            "pinKey": "H1lWAM_eAt"
          }
        },
        "rkgV4_lRK": {
          "id": "rkgV4_lRK",
          "input": {
            "nodeId": "HJp74dl0K",
            "pinKey": "HkXK-dGob"
          },
          "output": {
            "nodeId": "ByVgEdg0F",
            "pinKey": "S1XNXdeAF"
          }
        },
        "ByOS4_lRt": {
          "id": "ByOS4_lRt",
          "input": {
            "nodeId": "ByVgEdg0F",
            "pinKey": "BygDmOgRt"
          },
          "output": {
            "nodeId": "HJzBNOxRt",
            "pinKey": "HJU8CE2lW"
          }
        },
        "Bk6UEOeAK": {
          "id": "Bk6UEOeAK",
          "input": {
            "nodeId": "SJXLNOxCF",
            "pinKey": "HJAq-A_8-"
          },
          "output": {
            "nodeId": "ByVgEdg0F",
            "pinKey": "B1-WCGugAK"
          }
        },
        "SykwE_e0K": {
          "id": "SykwE_e0K",
          "input": {
            "nodeId": "rJ9UEul0t",
            "pinKey": "HJAq-A_8-"
          },
          "output": {
            "nodeId": "ByVgEdg0F",
            "pinKey": "H19JmuxAK"
          }
        },
        "H1yK4ueCK": {
          "id": "H1yK4ueCK",
          "input": {
            "nodeId": "ByVgEdg0F",
            "pinKey": "ByKD7dgRY"
          },
          "output": {
            "nodeId": "BJKON_gRt",
            "pinKey": "Bkf4BDsmV"
          }
        },
        "rk3KNug0t": {
          "id": "rk3KNug0t",
          "input": {
            "nodeId": "ryOtVdgAF",
            "pinKey": "HkXK-dGob"
          },
          "output": {
            "nodeId": "rJ9UEul0t",
            "pinKey": "r1yhZRd8W"
          }
        },
        "rkpKNOlRK": {
          "id": "rkpKNOlRK",
          "input": {
            "nodeId": "SJVYVugCF",
            "pinKey": "HkXK-dGob"
          },
          "output": {
            "nodeId": "SJXLNOxCF",
            "pinKey": "r1yhZRd8W"
          }
        }
      },
      "path": "@/example-hygrometer-thermometer",
      "description": "Patch for testing sensor. Run in debug mode."
    },
    "@/example-read-identifiers": {
      "nodes": {
        "rydLFxyCY": {
          "id": "rydLFxyCY",
          "position": {
            "x": 3,
            "y": 2,
            "units": "slots"
          },
          "type": "@/get-identifiers"
        },
        "B1dWYWk0Y": {
          "size": {
            "height": 1,
            "width": 5,
            "units": "slots"
          },
          "id": "B1dWYWk0Y",
          "position": {
            "x": -1,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/debug/watch"
        },
        "HyyMFZkCY": {
          "size": {
            "height": 1,
            "width": 4,
            "units": "slots"
          },
          "id": "HyyMFZkCY",
          "position": {
            "x": 4,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/debug/watch"
        },
        "H1Hw5WJCY": {
          "id": "H1Hw5WJCY",
          "position": {
            "x": 3,
            "y": 1,
            "units": "slots"
          },
          "type": "@/sht2x-device"
        },
        "ry-S2W1At": {
          "id": "ry-S2W1At",
          "position": {
            "x": 4,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/debug/tweak-pulse"
        }
      },
      "links": {
        "SyWzFZJRt": {
          "id": "SyWzFZJRt",
          "input": {
            "nodeId": "HyyMFZkCY",
            "pinKey": "HkXK-dGob"
          },
          "output": {
            "nodeId": "rydLFxyCY",
            "pinKey": "H1IfD-1CY"
          }
        },
        "B1QzYZ1At": {
          "id": "B1QzYZ1At",
          "input": {
            "nodeId": "B1dWYWk0Y",
            "pinKey": "HkXK-dGob"
          },
          "output": {
            "nodeId": "rydLFxyCY",
            "pinKey": "SklMv-1At"
          }
        },
        "S1dP9ZJAt": {
          "id": "S1dP9ZJAt",
          "input": {
            "nodeId": "rydLFxyCY",
            "pinKey": "SyN9v-yCt"
          },
          "output": {
            "nodeId": "H1Hw5WJCY",
            "pinKey": "H1UwlgyAF"
          }
        },
        "B18Sh-kCF": {
          "id": "B18Sh-kCF",
          "input": {
            "nodeId": "rydLFxyCY",
            "pinKey": "S1N-Dg1RF"
          },
          "output": {
            "nodeId": "ry-S2W1At",
            "pinKey": "Bkf4BDsmV"
          }
        }
      },
      "path": "@/example-read-identifiers",
      "description": "Patch for retrieving sensor identification numbers. Run in debug mode."
    },
    "@/hygrometer-thermometer": {
      "nodes": {
        "ByLtfOgRF": {
          "id": "ByLtfOgRF",
          "position": {
            "x": 3,
            "y": 1,
            "units": "slots"
          },
          "type": "@/sht2x-device"
        },
        "HkAFfOgRY": {
          "id": "HkAFfOgRY",
          "position": {
            "x": 3,
            "y": 2,
            "units": "slots"
          },
          "type": "@/read"
        },
        "SJXpzdeAY": {
          "id": "SJXpzdeAY",
          "position": {
            "x": 8,
            "y": 2,
            "units": "slots"
          },
          "type": "@/reset"
        },
        "H1-CfOg0Y": {
          "description": "Relative humidity (%).",
          "label": "RH",
          "id": "H1-CfOg0Y",
          "position": {
            "x": 3,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "H1lWAM_eAt": {
          "description": "Temperature (°C).",
          "label": "Temp",
          "id": "H1lWAM_eAt",
          "position": {
            "x": 4,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "B1-WCGugAK": {
          "description": "Pulse on read.",
          "label": "Done",
          "id": "B1-WCGugAK",
          "position": {
            "x": 6,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "H19JmuxAK": {
          "description": "Pulse on reset.",
          "label": "_Reset",
          "id": "H19JmuxAK",
          "position": {
            "x": 8,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "S1XNXdeAF": {
          "description": "Error code: 00h=OK, 81h=WRITECMD, 82h=READBYTES, 83h=HEATER_OFF, 84h=NOT_CONNECT, 85h=CRC_TEMP, 86h=CRC_HUM, 87h=CRC_STATUS, 88h=HEATER_COOLDOWN, 89h=HEATER_ON.",
          "label": "Error",
          "id": "S1XNXdeAF",
          "position": {
            "x": 5,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-byte"
        },
        "Sy0S7_gAK": {
          "description": "I²C bus",
          "label": "I2C",
          "id": "Sy0S7_gAK",
          "position": {
            "x": 3,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/i2c/input-i2c"
        },
        "BygDmOgRt": {
          "boundLiterals": {
            "__out__": "Continuously"
          },
          "description": "Update. Trigger read.",
          "label": "UPD",
          "id": "BygDmOgRt",
          "position": {
            "x": 4,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "ByKD7dgRY": {
          "boundLiterals": {
            "__out__": "Never"
          },
          "description": "Soft reset.",
          "label": "Reset",
          "id": "ByKD7dgRY",
          "position": {
            "x": 9,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        }
      },
      "links": {
        "ByugQdlAY": {
          "id": "ByugQdlAY",
          "input": {
            "nodeId": "H19JmuxAK",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "SJXpzdeAY",
            "pinKey": "S1NTe1_eAt"
          }
        },
        "r19fXueAF": {
          "id": "r19fXueAF",
          "input": {
            "nodeId": "H1-CfOg0Y",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "HkAFfOgRY",
            "pinKey": "SJWzRrfe0K"
          }
        },
        "rysM7dx0Y": {
          "id": "rysM7dx0Y",
          "input": {
            "nodeId": "H1lWAM_eAt",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "HkAFfOgRY",
            "pinKey": "H1fM0SflRY"
          }
        },
        "rkA4XdgAK": {
          "id": "rkA4XdgAK",
          "input": {
            "nodeId": "HkAFfOgRY",
            "pinKey": "SymMArGxAt"
          },
          "output": {
            "nodeId": "ByLtfOgRF",
            "pinKey": "H1UwlgyAF"
          }
        },
        "SkErQ_x0t": {
          "id": "SkErQ_x0t",
          "input": {
            "nodeId": "SJXpzdeAY",
            "pinKey": "BkmpgkdeCF"
          },
          "output": {
            "nodeId": "ByLtfOgRF",
            "pinKey": "H1UwlgyAF"
          }
        },
        "Hkm87ugCY": {
          "id": "Hkm87ugCY",
          "input": {
            "nodeId": "ByLtfOgRF",
            "pinKey": "BkGqegyCY"
          },
          "output": {
            "nodeId": "Sy0S7_gAK",
            "pinKey": "__out__"
          }
        },
        "H1IPXugCY": {
          "id": "H1IPXugCY",
          "input": {
            "nodeId": "HkAFfOgRY",
            "pinKey": "r1lfRrGlRK"
          },
          "output": {
            "nodeId": "BygDmOgRt",
            "pinKey": "__out__"
          }
        },
        "Hy3_mOeRF": {
          "id": "Hy3_mOeRF",
          "input": {
            "nodeId": "SJXpzdeAY",
            "pinKey": "S1xpe1_gRF"
          },
          "output": {
            "nodeId": "ByKD7dgRY",
            "pinKey": "__out__"
          }
        },
        "ryeho_g0t": {
          "id": "ryeho_g0t",
          "input": {
            "nodeId": "B1-WCGugAK",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "HkAFfOgRY",
            "pinKey": "SJVGASGe0F"
          }
        },
        "rybhjOxRF": {
          "id": "rybhjOxRF",
          "input": {
            "nodeId": "S1XNXdeAF",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "HkAFfOgRY",
            "pinKey": "rk7tcug0Y"
          }
        }
      },
      "path": "@/hygrometer-thermometer",
      "description": "Combines lower level nodes to create a ready to use sensor."
    },
    "@/get-identifiers": {
      "nodes": {
        "rk71wlJRY": {
          "id": "rk71wlJRY",
          "position": {
            "x": 1,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "S1N-Dg1RF": {
          "boundLiterals": {
            "__out__": "On Boot"
          },
          "description": "Update.",
          "label": "UPD",
          "id": "S1N-Dg1RF",
          "position": {
            "x": 2,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "SklMv-1At": {
          "description": "Electronic ID A.",
          "label": "EIDA",
          "id": "SklMv-1At",
          "position": {
            "x": 1,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "H1IfD-1CY": {
          "description": "Electronic ID B.",
          "label": "EIDB",
          "id": "H1IfD-1CY",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "SyN9v-yCt": {
          "description": "An SHT2x device.",
          "label": "DEV",
          "id": "SyN9v-yCt",
          "position": {
            "x": 1,
            "y": 0,
            "units": "slots"
          },
          "type": "@/input-sht2x-device"
        },
        "H1oRO-JRt": {
          "description": "Pulse on completion.",
          "label": "Done",
          "id": "H1oRO-JRt",
          "position": {
            "x": 3,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-pulse"
        }
      },
      "path": "@/get-identifiers",
      "description": "Report the electronic IDs of the SHT2x device.",
      "attachments": [
        {
          "filename": "patch.cpp",
          "encoding": "utf8",
          "content": "#pragma XOD evaluate_on_pin disable\n#pragma XOD evaluate_on_pin enable input_UPD\n\nnode {    \n    void evaluate(Context ctx) {\n        // The node responds only if there is an input pulse\n        if (!isInputDirty<input_UPD>(ctx))\n            return;\n\n        auto sensor = getValue<input_DEV>(ctx);\n        Number EIDA = sensor->getEIDA();\n        Number EIDB = sensor->getEIDB();\n        emitValue<output_EIDA>(ctx, EIDA);\n        emitValue<output_EIDB>(ctx, EIDB);\n        emitValue<output_Done>(ctx, 1);\n    }\n}\n"
        }
      ]
    },
    "@/read": {
      "nodes": {
        "HkfCHzg0Y": {
          "id": "HkfCHzg0Y",
          "position": {
            "x": 0,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "r1lfRrGlRK": {
          "boundLiterals": {
            "__out__": "Continuously"
          },
          "description": "Update. Triggers new read.",
          "label": "UPD",
          "id": "r1lfRrGlRK",
          "position": {
            "x": 1,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "SJWzRrfe0K": {
          "description": "Relative humidity (%).",
          "label": "RH",
          "id": "SJWzRrfe0K",
          "position": {
            "x": 0,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "H1fM0SflRY": {
          "description": "Temperature (°C).",
          "label": "Temp",
          "id": "H1fM0SflRY",
          "position": {
            "x": 1,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "SymMArGxAt": {
          "description": "An SHT2x device.",
          "label": "DEV",
          "id": "SymMArGxAt",
          "position": {
            "x": 0,
            "y": 0,
            "units": "slots"
          },
          "type": "@/input-sht2x-device"
        },
        "SJVGASGe0F": {
          "description": "Pulse on read.",
          "label": "Done",
          "id": "SJVGASGe0F",
          "position": {
            "x": 3,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "rk7tcug0Y": {
          "description": "Error code: 00h=OK, 81h=WRITECMD, 82h=READBYTES, 83h=HEATER_OFF, 84h=NOT_CONNECT, 85h=CRC_TEMP, 86h=CRC_HUM, 87h=CRC_STATUS, 88h=HEATER_COOLDOWN, 89h=HEATER_ON.",
          "label": "Error",
          "id": "rk7tcug0Y",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-byte"
        }
      },
      "path": "@/read",
      "description": "Measure relative humidity and temperature.",
      "attachments": [
        {
          "filename": "patch.cpp",
          "encoding": "utf8",
          "content": "#pragma XOD evaluate_on_pin disable\n#pragma XOD evaluate_on_pin enable input_UPD\n\nnode {    \n    void evaluate(Context ctx) {\n        // The node responds only if there is an input pulse\n        if (!isInputDirty<input_UPD>(ctx))\n            return;\n\n        auto sensor = getValue<input_DEV>(ctx);\n        sensor->read();\n        uint8_t errorCode = sensor->getError();\n        emitValue<output_Error>(ctx, errorCode);\n        if (errorCode!=0) {\n            raiseError<output_RH>(ctx);\n            raiseError<output_Temp>(ctx);\n            raiseError<output_Done>(ctx);\n        } else {\n            emitValue<output_RH>(ctx, sensor->getHumidity());\n            emitValue<output_Temp>(ctx, sensor->getTemperature());\n            emitValue<output_Done>(ctx, 1);\n        }\n    }\n}\n"
        }
      ]
    },
    "@/reset": {
      "nodes": {
        "r1axyul0t": {
          "id": "r1axyul0t",
          "position": {
            "x": 0,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "S1xpe1_gRF": {
          "boundLiterals": {
            "__out__": "Never"
          },
          "description": "Update. Trigger reset.",
          "label": "UPD",
          "id": "S1xpe1_gRF",
          "position": {
            "x": 1,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "BkmpgkdeCF": {
          "description": "An SHT2x device.",
          "label": "DEV",
          "id": "BkmpgkdeCF",
          "position": {
            "x": 0,
            "y": 0,
            "units": "slots"
          },
          "type": "@/input-sht2x-device"
        },
        "S1NTe1_eAt": {
          "description": "Pulse on read.",
          "label": "Done",
          "id": "S1NTe1_eAt",
          "position": {
            "x": 0,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-pulse"
        }
      },
      "path": "@/reset",
      "description": "Soft reset.",
      "attachments": [
        {
          "filename": "patch.cpp",
          "encoding": "utf8",
          "content": "#pragma XOD evaluate_on_pin disable\n#pragma XOD evaluate_on_pin enable input_UPD\n\nnode {    \n    void evaluate(Context ctx) {\n        // The node responds only if there is an input pulse\n        if (!isInputDirty<input_UPD>(ctx))\n            return;\n\n        auto sensor = getValue<input_DEV>(ctx);\n        sensor->reset();\n        emitValue<output_Done>(ctx, 1);\n    }\n}\n"
        }
      ]
    },
    "@/sht2x-device": {
      "nodes": {
        "SyWvicATt": {
          "id": "SyWvicATt",
          "position": {
            "x": 2,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "H1UwlgyAF": {
          "description": "An SHT2x device.",
          "label": "DEV",
          "id": "H1UwlgyAF",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-self"
        },
        "BkGqegyCY": {
          "description": "I²C bus",
          "label": "I2C",
          "id": "BkGqegyCY",
          "position": {
            "x": 2,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/i2c/input-i2c"
        }
      },
      "path": "@/sht2x-device",
      "description": "Create an SHT2x device.",
      "attachments": [
        {
          "filename": "patch.cpp",
          "encoding": "utf-8",
          "content": "// Tell XOD where it can download the libraries:\n#pragma XOD require \"https://github.com/RobTillaart/SHT2x\"\n\n//Include C++ libraries\n#include <Wire.h>\n#include <SHT2x.h>\n\nnode {\n\n    meta {\n        // Define our custom type as a pointer on the class instance.\n        using Type = SHT2x*;\n    }\n\n    uint8_t mem[sizeof(SHT2x)];\n    // Create an object of class SHT2x\n    SHT2x sensor = SHT2x();\n\n    void evaluate(Context ctx) {\n        // It should be evaluated only once on the first (setup) transaction\n        if (!isSettingUp())\n            return;\n\n        auto wire = getValue<input_I2C>(ctx);\n\n        Type sensor = new (mem) SHT2x(wire);\n        emitValue<output_DEV>(ctx, sensor);\n\n        // Try to initialize sensor\n        if (!sensor->begin()) {\n            raiseError(ctx);\n            return;\n        }\n        emitValue<output_DEV>(ctx, sensor);\n    }\n}\n"
        }
      ]
    }
  },
  "license": "MIT",
  "version": "0.0.3",
  "description": "Library for the Sensirion SHT2x series of humidity and temperature sensors. Wraps https://github.com/RobTillaart/SHT2x. Datasheet for SHT21: https://sensirion.com/resource/datasheet/sht21",
  "name": "sht2x-rh-temp"
}
