{
  "description": "Library for the \"money-counter\" device.",
  "name": "electricity-meter",
  "patches": {
    "@/acs712-05b-ac-current-sensor": {
      "comments": {
        "Hk3x8KGmJnX": {
          "content": "Sens for ACS712_05B",
          "id": "Hk3x8KGmJnX",
          "position": {
            "x": 578,
            "y": 0
          },
          "size": {
            "height": 51,
            "width": 204
          }
        }
      },
      "description": "Reads current value from the ACS712_05B sensor ",
      "links": {
        "B1_cfQkhQ": {
          "id": "B1_cfQkhQ",
          "input": {
            "nodeId": "SJg8YzQy2m",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "HkaFGQknX",
            "pinKey": "H1480W71hm"
          }
        },
        "BJ7S_BJ37": {
          "id": "BJ7S_BJ37",
          "input": {
            "nodeId": "HkaFGQknX",
            "pinKey": "HkSURZmy3Q"
          },
          "output": {
            "nodeId": "B1grOr1nQ",
            "pinKey": "B1x2RV3eZ"
          }
        },
        "BkYczXknX": {
          "id": "BkYczXknX",
          "input": {
            "nodeId": "Hk8tfQJ3X",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "HkaFGQknX",
            "pinKey": "SJGL0-Qy3m"
          }
        },
        "HJS3wcFnQ": {
          "id": "HJS3wcFnQ",
          "input": {
            "nodeId": "HkaFGQknX",
            "pinKey": "ByILCb71nm"
          },
          "output": {
            "nodeId": "SJZk2w5tnm",
            "pinKey": "__out__"
          }
        },
        "Skwhv9K27": {
          "id": "Skwhv9K27",
          "input": {
            "nodeId": "HkaFGQknX",
            "pinKey": "H1v8RZ7Jnm"
          },
          "output": {
            "nodeId": "H1k2w5Kh7",
            "pinKey": "__out__"
          }
        },
        "r18nwcKh7": {
          "id": "r18nwcKh7",
          "input": {
            "nodeId": "HkaFGQknX",
            "pinKey": "S1FLR-XynQ"
          },
          "output": {
            "nodeId": "ByMy3DcY3X",
            "pinKey": "__out__"
          }
        },
        "rkDUlDen7": {
          "id": "rkDUlDen7",
          "input": {
            "nodeId": "Hkb8tMX1n7",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "HkaFGQknX",
            "pinKey": "Byb80ZQknQ"
          }
        },
        "ryN3PqFhm": {
          "id": "ryN3PqFhm",
          "input": {
            "nodeId": "HkaFGQknX",
            "pinKey": "r1OU0ZQkhQ"
          },
          "output": {
            "nodeId": "Syxy3P9Y3Q",
            "pinKey": "__out__"
          }
        }
      },
      "nodes": {
        "B1grOr1nQ": {
          "boundLiterals": {
            "B1x2RV3eZ": "0.185"
          },
          "id": "B1grOr1nQ",
          "position": {
            "x": 544,
            "y": 0
          },
          "type": "xod/core/constant-number"
        },
        "ByMy3DcY3X": {
          "boundLiterals": {
            "__out__": "60"
          },
          "description": "AC frequency. The number of cycles per second in an alternating current sine wave ",
          "id": "ByMy3DcY3X",
          "label": "FRQ",
          "position": {
            "x": 510,
            "y": 102
          },
          "type": "xod/patch-nodes/input-number"
        },
        "H1k2w5Kh7": {
          "description": "Triggers new sensor read",
          "id": "H1k2w5Kh7",
          "label": "UPD",
          "position": {
            "x": 578,
            "y": 102
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "Hk8tfQJ3X": {
          "description": "Fires if update failed. E.g. `PORT` is not an ADC port.\n",
          "id": "Hk8tfQJ3X",
          "label": "ERR",
          "position": {
            "x": 510,
            "y": 306
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "HkaFGQknX": {
          "boundLiterals": {
            "HkSURZmy3Q": "0.185"
          },
          "id": "HkaFGQknX",
          "position": {
            "x": 442,
            "y": 204
          },
          "type": "@/acs712-read-ac"
        },
        "Hkb8tMX1n7": {
          "description": "A momentary current value in amperes",
          "id": "Hkb8tMX1n7",
          "label": "A",
          "position": {
            "x": 442,
            "y": 306
          },
          "type": "xod/patch-nodes/output-number"
        },
        "SJZk2w5tnm": {
          "boundLiterals": {
            "__out__": "5"
          },
          "description": "Analog voltage reference, i.e., the voltage level corresponding to the 1.0 value of an analog read. Usually 5 or 3.3 volts matching the board power voltage",
          "id": "SJZk2w5tnm",
          "label": "AREF",
          "position": {
            "x": 476,
            "y": 102
          },
          "type": "xod/patch-nodes/input-number"
        },
        "SJg8YzQy2m": {
          "description": "Fires on reading complete\n",
          "id": "SJg8YzQy2m",
          "label": "DONE",
          "position": {
            "x": 476,
            "y": 306
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "Syxy3P9Y3Q": {
          "boundLiterals": {
            "__out__": "A0"
          },
          "description": "Board port number the sensor is connected to.",
          "id": "Syxy3P9Y3Q",
          "label": "PORT",
          "position": {
            "x": 442,
            "y": 102
          },
          "type": "xod/patch-nodes/input-port"
        }
      },
      "path": "@/acs712-05b-ac-current-sensor"
    },
    "@/acs712-20a-ac-current-sensor": {
      "comments": {
        "ByxxaC49K37": {
          "content": "Sens for ACS712_20A",
          "id": "ByxxaC49K37",
          "position": {
            "x": 135,
            "y": -1
          },
          "size": {
            "height": 51,
            "width": 204
          }
        }
      },
      "description": "Reads current value from the ACS712_20A sensor ",
      "links": {
        "B1u9PcYnQ": {
          "id": "B1u9PcYnQ",
          "input": {
            "nodeId": "ByN6AE9Yh7",
            "pinKey": "ByILCb71nm"
          },
          "output": {
            "nodeId": "HybH5v5t2Q",
            "pinKey": "__out__"
          }
        },
        "BJK5PcFn7": {
          "id": "BJK5PcFn7",
          "input": {
            "nodeId": "ByN6AE9Yh7",
            "pinKey": "S1FLR-XynQ"
          },
          "output": {
            "nodeId": "HkzHcD9Fhm",
            "pinKey": "__out__"
          }
        },
        "BJRTCEqKnQ": {
          "id": "BJRTCEqKnQ",
          "input": {
            "nodeId": "SkST04qt2X",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "ByN6AE9Yh7",
            "pinKey": "Byb80ZQknQ"
          }
        },
        "ByjaCE9K3Q": {
          "id": "ByjaCE9K3Q",
          "input": {
            "nodeId": "Byf6AN5KnQ",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "ByN6AE9Yh7",
            "pinKey": "SJGL0-Qy3m"
          }
        },
        "HytTCN9Fn7": {
          "id": "HytTCN9Fn7",
          "input": {
            "nodeId": "ByN6AE9Yh7",
            "pinKey": "HkSURZmy3Q"
          },
          "output": {
            "nodeId": "r1aA49FhX",
            "pinKey": "B1x2RV3eZ"
          }
        },
        "SJ5qPcY27": {
          "id": "SJ5qPcY27",
          "input": {
            "nodeId": "ByN6AE9Yh7",
            "pinKey": "H1v8RZ7Jnm"
          },
          "output": {
            "nodeId": "SkB9P5YnX",
            "pinKey": "__out__"
          }
        },
        "SyvqPqY3X": {
          "id": "SyvqPqY3X",
          "input": {
            "nodeId": "ByN6AE9Yh7",
            "pinKey": "r1OU0ZQkhQ"
          },
          "output": {
            "nodeId": "BJlBcwcKhm",
            "pinKey": "__out__"
          }
        },
        "rJdaCE5KhX": {
          "id": "rJdaCE5KhX",
          "input": {
            "nodeId": "SkLTRE5YhQ",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "ByN6AE9Yh7",
            "pinKey": "H1480W71hm"
          }
        }
      },
      "nodes": {
        "BJlBcwcKhm": {
          "boundLiterals": {
            "__out__": "A0"
          },
          "description": "Board port number the sensor is connected to.",
          "id": "BJlBcwcKhm",
          "label": "PORT",
          "position": {
            "x": 0,
            "y": 102
          },
          "type": "xod/patch-nodes/input-port"
        },
        "ByN6AE9Yh7": {
          "boundLiterals": {
            "HkSURZmy3Q": "0.185"
          },
          "id": "ByN6AE9Yh7",
          "position": {
            "x": -1,
            "y": 203
          },
          "type": "@/acs712-read-ac"
        },
        "Byf6AN5KnQ": {
          "description": "Fires if update failed. E.g. `PORT` is not an ADC port.\n",
          "id": "Byf6AN5KnQ",
          "label": "ERR",
          "position": {
            "x": 67,
            "y": 305
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "HkzHcD9Fhm": {
          "boundLiterals": {
            "__out__": "60"
          },
          "description": "AC frequency. The number of cycles per second in an alternating current sine wave ",
          "id": "HkzHcD9Fhm",
          "label": "FRQ",
          "position": {
            "x": 68,
            "y": 102
          },
          "type": "xod/patch-nodes/input-number"
        },
        "HybH5v5t2Q": {
          "boundLiterals": {
            "__out__": "5"
          },
          "description": "Analog voltage reference, i.e., the voltage level corresponding to the 1.0 value of an analog read. Usually 5 or 3.3 volts matching the board power voltage",
          "id": "HybH5v5t2Q",
          "label": "AREF",
          "position": {
            "x": 34,
            "y": 102
          },
          "type": "xod/patch-nodes/input-number"
        },
        "SkB9P5YnX": {
          "description": "Triggers new sensor read",
          "id": "SkB9P5YnX",
          "label": "UPD",
          "position": {
            "x": 136,
            "y": 102
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "SkLTRE5YhQ": {
          "description": "Fires on reading complete\n",
          "id": "SkLTRE5YhQ",
          "label": "DONE",
          "position": {
            "x": 33,
            "y": 305
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "SkST04qt2X": {
          "description": "A momentary current value in amperes",
          "id": "SkST04qt2X",
          "label": "A",
          "position": {
            "x": -1,
            "y": 305
          },
          "type": "xod/patch-nodes/output-number"
        },
        "r1aA49FhX": {
          "boundLiterals": {
            "B1x2RV3eZ": "0.1"
          },
          "id": "r1aA49FhX",
          "position": {
            "x": 101,
            "y": -1
          },
          "type": "xod/core/constant-number"
        }
      },
      "path": "@/acs712-20a-ac-current-sensor"
    },
    "@/acs712-30a-ac-current-sensor": {
      "comments": {
        "HyxlNmBqF2X": {
          "content": "Sens for ACS712_30A",
          "id": "HyxlNmBqF2X",
          "position": {
            "x": 135,
            "y": -1
          },
          "size": {
            "height": 51,
            "width": 204
          }
        }
      },
      "description": "Reads current value from the ACS712_30A sensor ",
      "links": {
        "B1QsD9Fh7": {
          "id": "B1QsD9Fh7",
          "input": {
            "nodeId": "ByVNQB9F2X",
            "pinKey": "r1OU0ZQkhQ"
          },
          "output": {
            "nodeId": "SklxjP5Fh7",
            "pinKey": "__out__"
          }
        },
        "HJ_V7HcKh7": {
          "id": "HJ_V7HcKh7",
          "input": {
            "nodeId": "rkL47H9t3m",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "ByVNQB9F2X",
            "pinKey": "H1480W71hm"
          }
        },
        "HkoNXr5F3m": {
          "id": "HkoNXr5F3m",
          "input": {
            "nodeId": "Hyf47H5Fn7",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "ByVNQB9F2X",
            "pinKey": "SJGL0-Qy3m"
          }
        },
        "SkHivqthQ": {
          "id": "SkHivqthQ",
          "input": {
            "nodeId": "ByVNQB9F2X",
            "pinKey": "S1FLR-XynQ"
          },
          "output": {
            "nodeId": "Byzgow9tnQ",
            "pinKey": "__out__"
          }
        },
        "SkLjwcFnm": {
          "id": "SkLjwcFnm",
          "input": {
            "nodeId": "ByVNQB9F2X",
            "pinKey": "H1v8RZ7Jnm"
          },
          "output": {
            "nodeId": "rJejD9Y2X",
            "pinKey": "__out__"
          }
        },
        "r1VoPcFhQ": {
          "id": "r1VoPcFhQ",
          "input": {
            "nodeId": "ByVNQB9F2X",
            "pinKey": "ByILCb71nm"
          },
          "output": {
            "nodeId": "rJWljvqt2Q",
            "pinKey": "__out__"
          }
        },
        "rkF4mH5Y3Q": {
          "id": "rkF4mH5Y3Q",
          "input": {
            "nodeId": "ByVNQB9F2X",
            "pinKey": "HkSURZmy3Q"
          },
          "output": {
            "nodeId": "SJEXH5K2Q",
            "pinKey": "B1x2RV3eZ"
          }
        },
        "ryR4Xrqt2Q": {
          "id": "ryR4Xrqt2Q",
          "input": {
            "nodeId": "rkB4QrqKnX",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "ByVNQB9F2X",
            "pinKey": "Byb80ZQknQ"
          }
        }
      },
      "nodes": {
        "ByVNQB9F2X": {
          "boundLiterals": {
            "HkSURZmy3Q": "0.185"
          },
          "id": "ByVNQB9F2X",
          "position": {
            "x": -1,
            "y": 203
          },
          "type": "@/acs712-read-ac"
        },
        "Byzgow9tnQ": {
          "boundLiterals": {
            "__out__": "60"
          },
          "description": "AC frequency. The number of cycles per second in an alternating current sine wave ",
          "id": "Byzgow9tnQ",
          "label": "FRQ",
          "position": {
            "x": 68,
            "y": 102
          },
          "type": "xod/patch-nodes/input-number"
        },
        "Hyf47H5Fn7": {
          "description": "Fires if update failed. E.g. `PORT` is not an ADC port.\n",
          "id": "Hyf47H5Fn7",
          "label": "ERR",
          "position": {
            "x": 67,
            "y": 305
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "SJEXH5K2Q": {
          "boundLiterals": {
            "B1x2RV3eZ": "0.066"
          },
          "id": "SJEXH5K2Q",
          "position": {
            "x": 101,
            "y": -1
          },
          "type": "xod/core/constant-number"
        },
        "SklxjP5Fh7": {
          "boundLiterals": {
            "__out__": "A0"
          },
          "description": "Board port number the sensor is connected to.",
          "id": "SklxjP5Fh7",
          "label": "PORT",
          "position": {
            "x": 0,
            "y": 102
          },
          "type": "xod/patch-nodes/input-port"
        },
        "rJWljvqt2Q": {
          "boundLiterals": {
            "__out__": "5"
          },
          "description": "Analog voltage reference, i.e., the voltage level corresponding to the 1.0 value of an analog read. Usually 5 or 3.3 volts matching the board power voltage",
          "id": "rJWljvqt2Q",
          "label": "AREF",
          "position": {
            "x": 34,
            "y": 102
          },
          "type": "xod/patch-nodes/input-number"
        },
        "rJejD9Y2X": {
          "description": "Triggers new sensor read",
          "id": "rJejD9Y2X",
          "label": "UPD",
          "position": {
            "x": 136,
            "y": 102
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "rkB4QrqKnX": {
          "description": "A momentary current value in amperes",
          "id": "rkB4QrqKnX",
          "label": "A",
          "position": {
            "x": 0,
            "y": 306
          },
          "type": "xod/patch-nodes/output-number"
        },
        "rkL47H9t3m": {
          "description": "Fires on reading complete\n",
          "id": "rkL47H9t3m",
          "label": "DONE",
          "position": {
            "x": 33,
            "y": 305
          },
          "type": "xod/patch-nodes/output-pulse"
        }
      },
      "path": "@/acs712-30a-ac-current-sensor"
    },
    "@/acs712-read-ac": {
      "attachments": [
        {
          "content": "struct State {\n    float zero = 512;\n};\n\n{{ GENERATED_CODE }}\n\nvoid evaluate(Context ctx) {\n    auto state = getState(ctx);\n    const float adcScale = 1023.f;\n\n    uint8_t port = getValue<input_PORT>(ctx);\n    ::pinMode(port, INPUT);\n\n    if (isSettingUp()) {\n        uint16_t acc = 0;\n\t    for (int i = 0; i < 10; i++) {\n\t\t    acc += ::analogRead(port);\n\t    }\n\t    state->zero = acc / 10;\n    }\n\n    if (!isValidAnalogPort(port)) {\n        emitValue<output_ERR>(ctx, 1);\n        return;\n    }\n\n    if (isInputDirty<input_UPD>(ctx)){\n        float sensitivity = getValue<input_SENS>(ctx);\n        float vref = getValue<input_AREF>(ctx);\n\n        uint8_t frequency = getValue<input_FRQ>(ctx);\n        int16_t acc = 0;\n\n\t    uint32_t period = 1000000 / frequency;\n\t    uint32_t tStart = micros();\n\n\t    uint32_t isum = 0, measurementsCount = 0;\n\t    int32_t inow;\n\n\t    while (micros() - tStart < period) {\n\t\t    inow = ::analogRead(port) - state->zero;\n\t\t    isum += inow * inow;\n\t\t    measurementsCount++;\n\t    }\n\n\t    float current = sqrt(isum / measurementsCount) / adcScale * vref / sensitivity;\n\n        emitValue<output_A>(ctx, current);\n        emitValue<output_DONE>(ctx, 1);\n    }\n}\n",
          "encoding": "utf-8",
          "filename": "patch.cpp"
        }
      ],
      "nodes": {
        "ByILCb71nm": {
          "id": "ByILCb71nm",
          "label": "AREF",
          "position": {
            "x": 68,
            "y": 0
          },
          "type": "xod/patch-nodes/input-number"
        },
        "Byb80ZQknQ": {
          "description": "A momentary current value in amperes",
          "id": "Byb80ZQknQ",
          "label": "A",
          "position": {
            "x": 0,
            "y": 204
          },
          "type": "xod/patch-nodes/output-number"
        },
        "H1480W71hm": {
          "description": "Fires on reading complete",
          "id": "H1480W71hm",
          "label": "DONE",
          "position": {
            "x": 67,
            "y": 203
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "H1YYfUghQ": {
          "id": "H1YYfUghQ",
          "position": {
            "x": 68,
            "y": 102
          },
          "type": "xod/patch-nodes/utility"
        },
        "H1v8RZ7Jnm": {
          "boundLiterals": {
            "__out__": "Continuously"
          },
          "description": "Triggers new read",
          "id": "H1v8RZ7Jnm",
          "label": "UPD",
          "position": {
            "x": 272,
            "y": 0
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "HkSURZmy3Q": {
          "description": "Sensetivity of the sensor",
          "id": "HkSURZmy3Q",
          "label": "SENS",
          "position": {
            "x": 204,
            "y": 0
          },
          "type": "xod/patch-nodes/input-number"
        },
        "S1FLR-XynQ": {
          "description": "AC frequency. The number of cycles per second in an alternating current sine wave ",
          "id": "S1FLR-XynQ",
          "label": "FRQ",
          "position": {
            "x": 136,
            "y": 0
          },
          "type": "xod/patch-nodes/input-number"
        },
        "SJGL0-Qy3m": {
          "description": "Fires if update failed. E.g. `PORT` is not an ADC port.",
          "id": "SJGL0-Qy3m",
          "label": "ERR",
          "position": {
            "x": 135,
            "y": 203
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "r1OU0ZQkhQ": {
          "boundLiterals": {
            "__out__": "A0"
          },
          "description": "Analog port to read from. Should start with `A` to succeed.\n",
          "id": "r1OU0ZQkhQ",
          "label": "PORT",
          "position": {
            "x": -1,
            "y": -1
          },
          "type": "xod/patch-nodes/input-port"
        },
        "rJmIR-Q1hm": {
          "id": "rJmIR-Q1hm",
          "position": {
            "x": 0,
            "y": 102
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        }
      },
      "path": "@/acs712-read-ac"
    },
    "@/integrate-dt": {
      "description": "Integrates a value over time",
      "links": {
        "BJJCDDl37": {
          "id": "BJJCDDl37",
          "input": {
            "nodeId": "B1hUDDlhX",
            "pinKey": "HJAq-A_8-"
          },
          "output": {
            "nodeId": "HJ_iDDln7",
            "pinKey": "__out__"
          }
        },
        "BkWLDPghQ": {
          "id": "BkWLDPghQ",
          "input": {
            "nodeId": "SklIHPeh7",
            "pinKey": "B1GfLR_SPk-"
          },
          "output": {
            "nodeId": "SJsHvDehQ",
            "pinKey": "__out__"
          }
        },
        "ByhDDPen7": {
          "id": "ByhDDPen7",
          "input": {
            "nodeId": "HJOwwwlhX",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "B1hUDDlhX",
            "pinKey": "r1yhZRd8W"
          }
        },
        "HJ8TDwxnX": {
          "id": "HJ8TDwxnX",
          "input": {
            "nodeId": "B1hUDDlhX",
            "pinKey": "SkUjZA_L-"
          },
          "output": {
            "nodeId": "S1LhPPl37",
            "pinKey": "__out__"
          }
        },
        "HyoiPwx2Q": {
          "id": "HyoiPwx2Q",
          "input": {
            "nodeId": "HJSSHvl3X",
            "pinKey": "H1NuAXqEM"
          },
          "output": {
            "nodeId": "HJ_iDDln7",
            "pinKey": "__out__"
          }
        },
        "SkeUwDl3m": {
          "id": "SkeUwDl3m",
          "input": {
            "nodeId": "SklIHPeh7",
            "pinKey": "SJ4zUC_BD1-"
          },
          "output": {
            "nodeId": "HJSSHvl3X",
            "pinKey": "B1OK07cVz"
          }
        },
        "SyJvwDx2m": {
          "id": "SyJvwDx2m",
          "input": {
            "nodeId": "B1hUDDlhX",
            "pinKey": "HJvqZ0dLZ"
          },
          "output": {
            "nodeId": "SklIHPeh7",
            "pinKey": "BkQzLCurwJZ"
          }
        }
      },
      "nodes": {
        "B1hUDDlhX": {
          "id": "B1hUDDlhX",
          "position": {
            "x": 204,
            "y": 306
          },
          "type": "xod/core/count"
        },
        "HJOwwwlhX": {
          "description": "The accumulated value.",
          "id": "HJOwwwlhX",
          "position": {
            "x": 204,
            "y": 408
          },
          "type": "xod/patch-nodes/output-number"
        },
        "HJSSHvl3X": {
          "id": "HJSSHvl3X",
          "position": {
            "x": 170,
            "y": 102
          },
          "type": "xod/core/delta-time"
        },
        "HJ_iDDln7": {
          "description": "Triggers new update",
          "id": "HJ_iDDln7",
          "label": "UPD",
          "position": {
            "x": 238,
            "y": 0
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "S1LhPPl37": {
          "description": "Resets the output to 0",
          "id": "S1LhPPl37",
          "label": "RST",
          "position": {
            "x": 272,
            "y": 0
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "SJsHvDehQ": {
          "id": "SJsHvDehQ",
          "position": {
            "x": 136,
            "y": 0
          },
          "type": "xod/patch-nodes/input-number"
        },
        "SklIHPeh7": {
          "id": "SklIHPeh7",
          "position": {
            "x": 136,
            "y": 204
          },
          "type": "xod/core/multiply"
        }
      },
      "path": "@/integrate-dt"
    },
    "@/text-lcd-8x2": {
      "attachments": [
        {
          "content": "\n{{#global}}\n#include <LiquidCrystal.h>\n{{/global}}\n\nstruct State {\n    LiquidCrystal* lcd;\n};\n\n{{ GENERATED_CODE }}\n\nvoid printLine(LiquidCrystal* lcd, uint8_t lineIndex, XString str) {\n    lcd->setCursor(0, lineIndex);\n    uint8_t whitespace = 8;\n    for (auto it = str->iterate(); it; ++it, --whitespace)\n        lcd->write(*it);\n\n    // Clear the rest of the line\n    while (whitespace--)\n        lcd->write(' ');\n}\n\nvoid evaluate(Context ctx) {\n    if (!isInputDirty<input_UPD>(ctx))\n        return;\n\n    State* state = getState(ctx);\n    auto lcd = state->lcd;\n    if (!state->lcd) {\n        state->lcd = lcd = new LiquidCrystal(\n            (int)getValue<input_RS>(ctx),\n            (int)getValue<input_EN>(ctx),\n            (int)getValue<input_D4>(ctx),\n            (int)getValue<input_D5>(ctx),\n            (int)getValue<input_D6>(ctx),\n            (int)getValue<input_D7>(ctx));\n\n        lcd->begin(8, 2);\n    }\n\n    printLine(lcd, 0, getValue<input_L1>(ctx));\n    printLine(lcd, 1, getValue<input_L2>(ctx));\n\n    emitValue<output_DONE>(ctx, 1);\n}\n",
          "encoding": "utf-8",
          "filename": "patch.cpp"
        }
      ],
      "description": "Drives a text 8x2 LCD screen with HD44780 chip",
      "nodes": {
        "H1DBz79thm": {
          "id": "H1DBz79thm",
          "position": {
            "x": -1,
            "y": 101
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "H1FrzX5K2X": {
          "description": "Board GPIO port with LCD D7 pin",
          "id": "H1FrzX5K2X",
          "label": "D7",
          "position": {
            "x": 339,
            "y": -1
          },
          "type": "xod/patch-nodes/input-port"
        },
        "H1NrfXqKnm": {
          "description": "Board GPIO port with LCD D5 pin",
          "id": "H1NrfXqKnm",
          "label": "D5",
          "position": {
            "x": 203,
            "y": -1
          },
          "type": "xod/patch-nodes/input-port"
        },
        "H1dHGQ9t3X": {
          "description": "Board GPIO port with LCD RS pin",
          "id": "H1dHGQ9t3X",
          "label": "RS",
          "position": {
            "x": -1,
            "y": -1
          },
          "type": "xod/patch-nodes/input-port"
        },
        "HJ-HGm9Knm": {
          "description": "Text for the second line",
          "id": "HJ-HGm9Knm",
          "label": "L2",
          "position": {
            "x": 475,
            "y": -1
          },
          "type": "xod/patch-nodes/input-string"
        },
        "HJrBM7cY3m": {
          "description": "Fires when write is done",
          "id": "HJrBM7cY3m",
          "label": "DONE",
          "position": {
            "x": -1,
            "y": 203
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "rJSzm9Fhm": {
          "description": "Text for the first line",
          "id": "rJSzm9Fhm",
          "label": "L1",
          "position": {
            "x": 407,
            "y": -1
          },
          "type": "xod/patch-nodes/input-string"
        },
        "rJgBzX9F3Q": {
          "description": "Board GPIO port with LCD D4 pin",
          "id": "rJgBzX9F3Q",
          "label": "D4",
          "position": {
            "x": 135,
            "y": -1
          },
          "type": "xod/patch-nodes/input-port"
        },
        "ryLrfQ5th7": {
          "description": "Board GPIO port with LCD EN pin",
          "id": "ryLrfQ5th7",
          "label": "EN",
          "position": {
            "x": 67,
            "y": -1
          },
          "type": "xod/patch-nodes/input-port"
        },
        "ryMSG79t3m": {
          "description": "Board GPIO port with LCD D6 pin",
          "id": "ryMSG79t3m",
          "label": "D6",
          "position": {
            "x": 271,
            "y": -1
          },
          "type": "xod/patch-nodes/input-port"
        },
        "ryXHfQqF37": {
          "boundLiterals": {
            "__out__": "Continuously"
          },
          "description": "Triggers new write",
          "id": "ryXHfQqF37",
          "label": "UPD",
          "position": {
            "x": 543,
            "y": -1
          },
          "type": "xod/patch-nodes/input-pulse"
        }
      },
      "path": "@/text-lcd-8x2"
    },
    "@/to-money": {
      "comments": {
        "HJzlQpvyn7": {
          "content": "W * s -> kW * h",
          "id": "HJzlQpvyn7",
          "position": {
            "x": -204,
            "y": 0
          },
          "size": {
            "width": 136,
            "height": 51
          }
        }
      },
      "description": "Calculates amount of money spent depending on power consumption and electricity cost",
      "links": {
        "B1gb-dlnQ": {
          "id": "B1gb-dlnQ",
          "input": {
            "nodeId": "rkJ-Z_e27",
            "pinKey": "ryPdedg3m"
          },
          "output": {
            "nodeId": "Sks0hDk2Q",
            "pinKey": "__out__"
          }
        },
        "Bk-bbdlh7": {
          "id": "Bk-bbdlh7",
          "input": {
            "nodeId": "H13Lxdk2X",
            "pinKey": "B1GfLR_SPk-"
          },
          "output": {
            "nodeId": "rkJ-Z_e27",
            "pinKey": "r1zYlux2X"
          }
        },
        "BkSqEIxhQ": {
          "id": "BkSqEIxhQ",
          "input": {
            "nodeId": "H13Lxdk2X",
            "pinKey": "SJ4zUC_BD1-"
          },
          "output": {
            "nodeId": "BkO4xd1nQ",
            "pinKey": "__out__"
          }
        },
        "HkTbBIe3Q": {
          "id": "HkTbBIe3Q",
          "input": {
            "nodeId": "By4bSLenX",
            "pinKey": "BJlHojaWZ"
          },
          "output": {
            "nodeId": "H13Lxdk2X",
            "pinKey": "BkQzLCurwJZ"
          }
        },
        "r1AZYpYhm": {
          "id": "r1AZYpYhm",
          "input": {
            "nodeId": "HJF7SUxhm",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "B1KWKTKnX",
            "pinKey": "rksccsp-W"
          }
        },
        "ryl7Kat2m": {
          "id": "ryl7Kat2m",
          "input": {
            "nodeId": "B1KWKTKnX",
            "pinKey": "BkeKcj6ZZ"
          },
          "output": {
            "nodeId": "By4bSLenX",
            "pinKey": "r1H_oipZb"
          }
        }
      },
      "nodes": {
        "B1KWKTKnX": {
          "boundLiterals": {
            "BkeKcj6ZZ": "\"$\"",
            "Hkqu9oaWb": "\"$\""
          },
          "id": "B1KWKTKnX",
          "position": {
            "x": -68,
            "y": 306
          },
          "type": "xod/core/concat"
        },
        "BkO4xd1nQ": {
          "description": "Price of a 1 kilowatt per hour in US dollars",
          "id": "BkO4xd1nQ",
          "label": "PRC",
          "position": {
            "x": 0,
            "y": -102
          },
          "type": "xod/patch-nodes/input-number"
        },
        "By4bSLenX": {
          "boundLiterals": {
            "HJTIija-W": "5"
          },
          "id": "By4bSLenX",
          "position": {
            "x": -34,
            "y": 204
          },
          "type": "xod/core/format-number"
        },
        "H13Lxdk2X": {
          "boundLiterals": {
            "SJ4zUC_BD1-": "0.17"
          },
          "id": "H13Lxdk2X",
          "position": {
            "x": -34,
            "y": 102
          },
          "type": "xod/core/multiply"
        },
        "HJF7SUxhm": {
          "description": "Amount of money spent ",
          "id": "HJF7SUxhm",
          "label": "$",
          "position": {
            "x": -68,
            "y": 408
          },
          "type": "xod/patch-nodes/output-string"
        },
        "Sks0hDk2Q": {
          "description": "Power consumption value",
          "id": "Sks0hDk2Q",
          "label": "Ws",
          "position": {
            "x": -68,
            "y": -102
          },
          "type": "xod/patch-nodes/input-number"
        },
        "rkJ-Z_e27": {
          "id": "rkJ-Z_e27",
          "position": {
            "x": -68,
            "y": 0
          },
          "type": "@/watt-sec-to-kilowatt-hour"
        }
      },
      "path": "@/to-money"
    },
    "@/watt-sec-to-kilowatt-hour": {
      "description": "Transforms watt*sec to kilowatt*hour",
      "links": {
        "SyLKeuenm": {
          "id": "SyLKeuenm",
          "input": {
            "nodeId": "r1zYlux2X",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "H1xDuxdxh7",
            "pinKey": "BkqLCOSw1W"
          }
        },
        "SyWvugOl37": {
          "id": "SyWvugOl37",
          "input": {
            "nodeId": "H1xDuxdxh7",
            "pinKey": "SkdIRuBD1b"
          },
          "output": {
            "nodeId": "ryPdedg3m",
            "pinKey": "__out__"
          }
        }
      },
      "nodes": {
        "H1xDuxdxh7": {
          "boundLiterals": {
            "BytUCdHD1-": "3600000"
          },
          "id": "H1xDuxdxh7",
          "position": {
            "x": -1,
            "y": 101
          },
          "type": "xod/core/divide"
        },
        "r1zYlux2X": {
          "id": "r1zYlux2X",
          "position": {
            "x": 0,
            "y": 204
          },
          "type": "xod/patch-nodes/output-number"
        },
        "ryPdedg3m": {
          "id": "ryPdedg3m",
          "label": "IN",
          "position": {
            "x": -1,
            "y": -1
          },
          "type": "xod/patch-nodes/input-number"
        }
      },
      "path": "@/watt-sec-to-kilowatt-hour"
    },
    "@/example-program": {
      "description": "Example of the \"money counter\" program",
      "links": {
        "B1vnloY27": {
          "id": "B1vnloY27",
          "input": {
            "nodeId": "B1TsliYhQ",
            "pinKey": "SJsHvDehQ"
          },
          "output": {
            "nodeId": "BJznxoKhX",
            "pinKey": "BkQzLCurwJZ"
          }
        },
        "BkXagoKnX": {
          "id": "BkXagoKnX",
          "input": {
            "nodeId": "B1TsliYhQ",
            "pinKey": "HJ_iDDln7"
          },
          "output": {
            "nodeId": "SyERD5YnX",
            "pinKey": "SkLTRE5YhQ"
          }
        },
        "HyVpQpKn7": {
          "id": "HyVpQpKn7",
          "input": {
            "nodeId": "rkjPMsthX",
            "pinKey": "Sks0hDk2Q"
          },
          "output": {
            "nodeId": "B1TsliYhQ",
            "pinKey": "HJOwwwlhX"
          }
        },
        "SkS3ejYnm": {
          "id": "SkS3ejYnm",
          "input": {
            "nodeId": "BJznxoKhX",
            "pinKey": "SJ4zUC_BD1-"
          },
          "output": {
            "nodeId": "SyERD5YnX",
            "pinKey": "SkST04qt2X"
          }
        },
        "SylCdpt2m": {
          "id": "SylCdpt2m",
          "input": {
            "nodeId": "SkRaOTYnm",
            "pinKey": "HJ-HGm9Knm"
          },
          "output": {
            "nodeId": "rkjPMsthX",
            "pinKey": "HJF7SUxhm"
          }
        }
      },
      "nodes": {
        "B1TsliYhQ": {
          "id": "B1TsliYhQ",
          "position": {
            "x": 170,
            "y": 408
          },
          "type": "@/integrate-dt"
        },
        "BJznxoKhX": {
          "boundLiterals": {
            "B1GfLR_SPk-": "230",
            "SJ4zUC_BD1-": "220"
          },
          "id": "BJznxoKhX",
          "position": {
            "x": 136,
            "y": 306
          },
          "type": "xod/core/multiply"
        },
        "SkRaOTYnm": {
          "boundLiterals": {
            "H1FrzX5K2X": "D2",
            "H1NrfXqKnm": "D4",
            "H1dHGQ9t3X": "D12",
            "rJSzm9Fhm": "\"Total:\"",
            "rJgBzX9F3Q": "D5",
            "ryLrfQ5th7": "D11",
            "ryMSG79t3m": "D3"
          },
          "id": "SkRaOTYnm",
          "position": {
            "x": -34,
            "y": 612
          },
          "type": "@/text-lcd-8x2"
        },
        "SyERD5YnX": {
          "boundLiterals": {
            "HkzHcD9Fhm": "50"
          },
          "id": "SyERD5YnX",
          "position": {
            "x": 170,
            "y": 204
          },
          "type": "@/acs712-20a-ac-current-sensor"
        },
        "rkjPMsthX": {
          "id": "rkjPMsthX",
          "position": {
            "x": 204,
            "y": 510
          },
          "type": "@/to-money"
        }
      },
      "path": "@/example-program"
    },
    "@/example-extended-program": {
      "nodes": {
        "rkqumBgCm": {
          "id": "rkqumBgCm",
          "position": {
            "x": 340,
            "y": 204
          },
          "type": "@/integrate-dt"
        },
        "SkxcuXHxC7": {
          "boundLiterals": {
            "B1GfLR_SPk-": "230",
            "SJ4zUC_BD1-": "220"
          },
          "id": "SkxcuXHxC7",
          "position": {
            "x": 238,
            "y": 204
          },
          "type": "xod/core/multiply"
        },
        "SybcumSxR7": {
          "boundLiterals": {
            "H1FrzX5K2X": "D2",
            "H1NrfXqKnm": "D4",
            "H1dHGQ9t3X": "D12",
            "rJSzm9Fhm": "\"Total:\"",
            "rJgBzX9F3Q": "D5",
            "ryLrfQ5th7": "D11",
            "ryMSG79t3m": "D3"
          },
          "id": "SybcumSxR7",
          "position": {
            "x": 68,
            "y": 510
          },
          "type": "@/text-lcd-8x2"
        },
        "Skf9_QreCQ": {
          "boundLiterals": {
            "HkzHcD9Fhm": "50"
          },
          "id": "Skf9_QreCQ",
          "position": {
            "x": 204,
            "y": 102
          },
          "type": "@/acs712-20a-ac-current-sensor"
        },
        "rkZAmrxAQ": {
          "id": "rkZAmrxAQ",
          "type": "xod/core/concat",
          "position": {
            "x": 136,
            "y": 408
          },
          "boundLiterals": {
            "Hkqu9oaWb": "\"A\"",
            "BkeKcj6ZZ-$1": "\"W\"",
            "BkeKcj6ZZ-$2": "\"W\""
          },
          "arityLevel": 3
        },
        "BJEbrBlAQ": {
          "id": "BJEbrBlAQ",
          "type": "@/watt-sec-to-kilowatt-hour",
          "position": {
            "x": 340,
            "y": 306
          }
        },
        "rysbrSg0m": {
          "id": "rysbrSg0m",
          "type": "xod/core/concat",
          "position": {
            "x": 306,
            "y": 408
          },
          "boundLiterals": {
            "Hkqu9oaWb": "\"C\""
          }
        },
        "S1K4HHlCm": {
          "id": "S1K4HHlCm",
          "type": "xod/core/format-number",
          "position": {
            "x": 408,
            "y": 306
          },
          "boundLiterals": {
            "HJTIija-W": "5"
          }
        },
        "ryfX8HeAQ": {
          "id": "ryfX8HeAQ",
          "type": "xod/core/pad-with-zeroes",
          "position": {
            "x": 238,
            "y": 306
          },
          "boundLiterals": {
            "BkKz5GVwX": "3"
          }
        },
        "BJywYBgRQ": {
          "id": "BJywYBgRQ",
          "type": "xod/core/format-number",
          "position": {
            "x": 136,
            "y": 306
          },
          "boundLiterals": {
            "HJTIija-W": "1"
          }
        },
        "SJMHqHeC7": {
          "id": "SJMHqHeC7",
          "type": "xod/common-hardware/button",
          "position": {
            "x": 408,
            "y": 102
          },
          "boundLiterals": {
            "ByNiWkt8Z": "D10"
          }
        }
      },
      "links": {
        "H1N9uQreRQ": {
          "id": "H1N9uQreRQ",
          "input": {
            "nodeId": "rkqumBgCm",
            "pinKey": "SJsHvDehQ"
          },
          "output": {
            "nodeId": "SkxcuXHxC7",
            "pinKey": "BkQzLCurwJZ"
          }
        },
        "BkBcOQHe0X": {
          "id": "BkBcOQHe0X",
          "input": {
            "nodeId": "rkqumBgCm",
            "pinKey": "HJ_iDDln7"
          },
          "output": {
            "nodeId": "Skf9_QreCQ",
            "pinKey": "SkLTRE5YhQ"
          }
        },
        "BkD5uXHlC7": {
          "id": "BkD5uXHlC7",
          "input": {
            "nodeId": "SkxcuXHxC7",
            "pinKey": "SJ4zUC_BD1-"
          },
          "output": {
            "nodeId": "Skf9_QreCQ",
            "pinKey": "SkST04qt2X"
          }
        },
        "S1HWrBlC7": {
          "id": "S1HWrBlC7",
          "output": {
            "nodeId": "rkqumBgCm",
            "pinKey": "HJOwwwlhX"
          },
          "input": {
            "nodeId": "BJEbrBlAQ",
            "pinKey": "ryPdedg3m"
          }
        },
        "SJCWrHgCm": {
          "id": "SJCWrHgCm",
          "output": {
            "nodeId": "rysbrSg0m",
            "pinKey": "rksccsp-W"
          },
          "input": {
            "nodeId": "SybcumSxR7",
            "pinKey": "HJ-HGm9Knm"
          }
        },
        "B134HBg0Q": {
          "id": "B134HBg0Q",
          "output": {
            "nodeId": "BJEbrBlAQ",
            "pinKey": "r1zYlux2X"
          },
          "input": {
            "nodeId": "S1K4HHlCm",
            "pinKey": "BJlHojaWZ"
          }
        },
        "BJPUSHeRQ": {
          "id": "BJPUSHeRQ",
          "output": {
            "nodeId": "S1K4HHlCm",
            "pinKey": "r1H_oipZb"
          },
          "input": {
            "nodeId": "rysbrSg0m",
            "pinKey": "BkeKcj6ZZ"
          }
        },
        "ry_QUSlRX": {
          "id": "ry_QUSlRX",
          "output": {
            "nodeId": "SkxcuXHxC7",
            "pinKey": "BkQzLCurwJZ"
          },
          "input": {
            "nodeId": "ryfX8HeAQ",
            "pinKey": "H1DWqMVw7"
          }
        },
        "ryHeDBlRX": {
          "id": "ryHeDBlRX",
          "output": {
            "nodeId": "ryfX8HeAQ",
            "pinKey": "Hk2bcGVDm"
          },
          "input": {
            "nodeId": "rkZAmrxAQ",
            "pinKey": "BkeKcj6ZZ-$2"
          }
        },
        "Hk_gYSx07": {
          "id": "Hk_gYSx07",
          "output": {
            "nodeId": "rkZAmrxAQ",
            "pinKey": "rksccsp-W"
          },
          "input": {
            "nodeId": "SybcumSxR7",
            "pinKey": "rJSzm9Fhm"
          }
        },
        "HkUwYBe0Q": {
          "id": "HkUwYBe0Q",
          "output": {
            "nodeId": "BJywYBgRQ",
            "pinKey": "r1H_oipZb"
          },
          "input": {
            "nodeId": "rkZAmrxAQ",
            "pinKey": "BkeKcj6ZZ"
          }
        },
        "Sy_PYHx0X": {
          "id": "Sy_PYHx0X",
          "output": {
            "nodeId": "Skf9_QreCQ",
            "pinKey": "SkST04qt2X"
          },
          "input": {
            "nodeId": "BJywYBgRQ",
            "pinKey": "BJlHojaWZ"
          }
        },
        "HkPHqrgRm": {
          "id": "HkPHqrgRm",
          "output": {
            "nodeId": "SJMHqHeC7",
            "pinKey": "BJ--G1tI-"
          },
          "input": {
            "nodeId": "rkqumBgCm",
            "pinKey": "S1LhPPl37"
          }
        }
      },
      "path": "@/example-extended-program",
      "description": "Example of the extended \"money counter\" program"
    }
  },
  "version": "0.0.1"
}
