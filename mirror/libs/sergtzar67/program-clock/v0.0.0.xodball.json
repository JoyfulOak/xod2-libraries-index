{
  "apiKey": "e57003f6-d455-4c10-a6ef-4ffed9b84071",
  "name": "program-clock",
  "patches": {
    "@/clock": {
      "links": {
        "BJt6aE1OL": {
          "id": "BJt6aE1OL",
          "input": {
            "nodeId": "SkkaT4kuL",
            "pinKey": "S1-M2YemPQ"
          },
          "output": {
            "nodeId": "By8pz6XvL",
            "pinKey": "H1avJ67wL"
          }
        },
        "S1QpT4yu8": {
          "id": "S1QpT4yu8",
          "input": {
            "nodeId": "SkkaT4kuL",
            "pinKey": "HygQhYlQw7"
          },
          "output": {
            "nodeId": "By8pz6XvL",
            "pinKey": "rJdLkaXv8"
          }
        },
        "rkUapNJ_U": {
          "id": "rkUapNJ_U",
          "input": {
            "nodeId": "SkkaT4kuL",
            "pinKey": "SkQnYg7wQ"
          },
          "output": {
            "nodeId": "By8pz6XvL",
            "pinKey": "SymvJamwU"
          }
        },
        "SJZyZBy_8": {
          "id": "SJZyZBy_8",
          "output": {
            "nodeId": "SkkaT4kuL",
            "pinKey": "r1ZqKlXPX"
          },
          "input": {
            "nodeId": "HykyZHkOI",
            "pinKey": "B1ruG2oLL"
          }
        },
        "HJ8kWr1_8": {
          "id": "HJ8kWr1_8",
          "output": {
            "nodeId": "SkkaT4kuL",
            "pinKey": "r1ZqKlXPX"
          },
          "input": {
            "nodeId": "ByrJ-r1u8",
            "pinKey": "rkx0QhiU8"
          }
        },
        "S1vG-Hk_U": {
          "id": "S1vG-Hk_U",
          "output": {
            "nodeId": "HykyZHkOI",
            "pinKey": "S1Lx72j8U"
          },
          "input": {
            "nodeId": "ryUzWByOL",
            "pinKey": "__in__"
          }
        },
        "S1af-B1uL": {
          "id": "S1af-B1uL",
          "output": {
            "nodeId": "ByrJ-r1u8",
            "pinKey": "H1mUE3jII"
          },
          "input": {
            "nodeId": "HysGWS1dL",
            "pinKey": "__in__"
          }
        }
      },
      "nodes": {
        "By8pz6XvL": {
          "boundLiterals": {
            "H1EqFaXwI": "1",
            "S1dHnbJ_U": "2",
            "rJNiq-Ju8": "59"
          },
          "description": "Real-time software clock",
          "id": "By8pz6XvL",
          "position": {
            "x": 5,
            "y": 1,
            "units": "slots"
          },
          "type": "@/program-clock"
        },
        "SkkaT4kuL": {
          "id": "SkkaT4kuL",
          "position": {
            "x": 5,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/datetime/datetime"
        },
        "HykyZHkOI": {
          "id": "HykyZHkOI",
          "type": "@/format-timestamp-date",
          "position": {
            "x": 5,
            "y": 3,
            "units": "slots"
          }
        },
        "ByrJ-r1u8": {
          "id": "ByrJ-r1u8",
          "type": "@/format-timestamp-time",
          "position": {
            "x": 7,
            "y": 3,
            "units": "slots"
          }
        },
        "ryUzWByOL": {
          "id": "ryUzWByOL",
          "type": "xod/patch-nodes/output-string",
          "position": {
            "x": 5,
            "y": 4,
            "units": "slots"
          },
          "label": "Date"
        },
        "HysGWS1dL": {
          "id": "HysGWS1dL",
          "type": "xod/patch-nodes/output-string",
          "position": {
            "x": 7,
            "y": 4,
            "units": "slots"
          },
          "label": "Time"
        }
      },
      "path": "@/clock"
    },
    "@/format-timestamp-date": {
      "links": {
        "BJhVX3s8I": {
          "id": "BJhVX3s8I",
          "input": {
            "nodeId": "BJY2GhiUU",
            "pinKey": "BkeKcj6ZZ-$2"
          },
          "output": {
            "nodeId": "BkS5fnsIU",
            "pinKey": "Hk2bcGVDm"
          }
        },
        "Byogm3oI8": {
          "id": "Byogm3oI8",
          "input": {
            "nodeId": "S1Lx72j8U",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "BJY2GhiUU",
            "pinKey": "rksccsp-W"
          }
        },
        "HJ3iz3sUL": {
          "id": "HJ3iz3sUL",
          "input": {
            "nodeId": "BydoG2jU8",
            "pinKey": "H1DWqMVw7"
          },
          "output": {
            "nodeId": "SJxYG3sII",
            "pinKey": "rJglsCgmvm"
          }
        },
        "HyANXnoIU": {
          "id": "HyANXnoIU",
          "input": {
            "nodeId": "BJY2GhiUU",
            "pinKey": "BkeKcj6ZZ"
          },
          "output": {
            "nodeId": "BydoG2jU8",
            "pinKey": "Hk2bcGVDm"
          }
        },
        "SJaqGns8I": {
          "id": "SJaqGns8I",
          "input": {
            "nodeId": "BkS5fnsIU",
            "pinKey": "H1DWqMVw7"
          },
          "output": {
            "nodeId": "SJxYG3sII",
            "pinKey": "SJgsCeQvm"
          }
        },
        "SkIYz3jU8": {
          "id": "SkIYz3jU8",
          "input": {
            "nodeId": "SJxYG3sII",
            "pinKey": "rkCYRgQDm"
          },
          "output": {
            "nodeId": "B1ruG2oLL",
            "pinKey": "__out__"
          }
        }
      },
      "nodes": {
        "B1ruG2oLL": {
          "id": "B1ruG2oLL",
          "position": {
            "x": 5,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/datetime/input-datetime"
        },
        "BJY2GhiUU": {
          "arityLevel": 3,
          "boundLiterals": {
            "BkeKcj6ZZ": "\":\"",
            "BkeKcj6ZZ-$1": "\":\"",
            "BkeKcj6ZZ-$10": "\"\"",
            "BkeKcj6ZZ-$2": "\"\"",
            "BkeKcj6ZZ-$4": "\" \"",
            "BkeKcj6ZZ-$6": "\":\"",
            "BkeKcj6ZZ-$8": "\":\"",
            "Hkqu9oaWb": "\"Date \""
          },
          "id": "BJY2GhiUU",
          "position": {
            "x": 6,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/core/concat"
        },
        "BkS5fnsIU": {
          "boundLiterals": {
            "BkKz5GVwX": "2"
          },
          "id": "BkS5fnsIU",
          "position": {
            "x": 6,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/core/pad-with-zeroes"
        },
        "BydoG2jU8": {
          "boundLiterals": {
            "BkKz5GVwX": "2"
          },
          "id": "BydoG2jU8",
          "position": {
            "x": 8,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/core/pad-with-zeroes"
        },
        "S1Lx72j8U": {
          "id": "S1Lx72j8U",
          "position": {
            "x": 6,
            "y": 4,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-string"
        },
        "SJxYG3sII": {
          "id": "SJxYG3sII",
          "position": {
            "x": 5,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/datetime/unpack-datetime"
        }
      },
      "path": "@/format-timestamp-date"
    },
    "@/format-timestamp-time": {
      "links": {
        "B13_NnjIU": {
          "id": "B13_NnjIU",
          "input": {
            "nodeId": "BJGGVhi88",
            "pinKey": "BkeKcj6ZZ-$2"
          },
          "output": {
            "nodeId": "SkllE3jIU",
            "pinKey": "Hk2bcGVDm"
          }
        },
        "B1ztN2i8U": {
          "id": "B1ztN2i8U",
          "input": {
            "nodeId": "BJGGVhi88",
            "pinKey": "BkeKcj6ZZ"
          },
          "output": {
            "nodeId": "SJqkN3oUU",
            "pinKey": "Hk2bcGVDm"
          }
        },
        "BJv843iUL": {
          "id": "BJv843iUL",
          "input": {
            "nodeId": "H1mUE3jII",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "BJGGVhi88",
            "pinKey": "rksccsp-W"
          }
        },
        "SJL-EnoLU": {
          "id": "SJL-EnoLU",
          "input": {
            "nodeId": "SJqkN3oUU",
            "pinKey": "H1DWqMVw7"
          },
          "output": {
            "nodeId": "HJ9RmhiUU",
            "pinKey": "BJZls0g7DQ"
          }
        },
        "SJfOE2jUL": {
          "id": "SJfOE2jUL",
          "input": {
            "nodeId": "BJGGVhi88",
            "pinKey": "BkeKcj6ZZ-$4"
          },
          "output": {
            "nodeId": "BkGgV2s8I",
            "pinKey": "Hk2bcGVDm"
          }
        },
        "Sk0Am2jUL": {
          "id": "Sk0Am2jUL",
          "input": {
            "nodeId": "HJ9RmhiUU",
            "pinKey": "rkCYRgQDm"
          },
          "output": {
            "nodeId": "rkx0QhiU8",
            "pinKey": "__out__"
          }
        },
        "SkmZ4njUI": {
          "id": "SkmZ4njUI",
          "input": {
            "nodeId": "SkllE3jIU",
            "pinKey": "H1DWqMVw7"
          },
          "output": {
            "nodeId": "HJ9RmhiUU",
            "pinKey": "r1MljClXPm"
          }
        },
        "rke-VhoUL": {
          "id": "rke-VhoUL",
          "input": {
            "nodeId": "BkGgV2s8I",
            "pinKey": "H1DWqMVw7"
          },
          "output": {
            "nodeId": "HJ9RmhiUU",
            "pinKey": "BkbiCl7v7"
          }
        }
      },
      "nodes": {
        "BJGGVhi88": {
          "arityLevel": 5,
          "boundLiterals": {
            "BkeKcj6ZZ": "\":\"",
            "BkeKcj6ZZ-$1": "\":\"",
            "BkeKcj6ZZ-$10": "\"\"",
            "BkeKcj6ZZ-$2": "\":\"",
            "BkeKcj6ZZ-$3": "\":\"",
            "BkeKcj6ZZ-$4": "\" \"",
            "BkeKcj6ZZ-$6": "\":\"",
            "BkeKcj6ZZ-$8": "\":\"",
            "Hkqu9oaWb": "\"Time \""
          },
          "id": "BJGGVhi88",
          "position": {
            "x": 7,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/core/concat"
        },
        "BkGgV2s8I": {
          "boundLiterals": {
            "BkKz5GVwX": "2"
          },
          "id": "BkGgV2s8I",
          "position": {
            "x": 11,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/core/pad-with-zeroes"
        },
        "H1mUE3jII": {
          "id": "H1mUE3jII",
          "position": {
            "x": 7,
            "y": 4,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-string"
        },
        "HJ9RmhiUU": {
          "id": "HJ9RmhiUU",
          "position": {
            "x": 5,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/datetime/unpack-datetime"
        },
        "SJqkN3oUU": {
          "boundLiterals": {
            "BkKz5GVwX": "2"
          },
          "id": "SJqkN3oUU",
          "position": {
            "x": 7,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/core/pad-with-zeroes"
        },
        "SkllE3jIU": {
          "boundLiterals": {
            "BkKz5GVwX": "2"
          },
          "id": "SkllE3jIU",
          "position": {
            "x": 9,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/core/pad-with-zeroes"
        },
        "rkx0QhiU8": {
          "id": "rkx0QhiU8",
          "position": {
            "x": 5,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/datetime/input-datetime"
        }
      },
      "path": "@/format-timestamp-time"
    },
    "@/program-clock": {
      "attachments": [
        {
          "content": "struct State {\n  TimeMs nextTrig;\n};\n\n   {{ GENERATED_CODE }}\n\n    uint8_t minutes = 0;\n    uint8_t seconds=0;\n    uint8_t hours=0;\nvoid evaluate(Context ctx) {\n    State* state = getState(ctx);\n    TimeMs tNow = transactionTime();\n    TimeMs tNext = 0;\n    // как только разница между текущим временем и временем записанным в tNext становится больше 1000 миллисекунд...\n    while(tNext-tNow > 1000){\n    //...обновляем  tNext и добавляем к счетчику Секунд +1\n        tNext=tNow;\n        seconds+=1;\n    if (seconds > 59) {\n        seconds = 0;\n    // как только счетчик секунд достигнет 60, обнуляем его и добавляем к счетчику Минут +1...\n        minutes+=1;\n    emitValue<output_MIN>(ctx, minutes);\n    }\n    // ...тоже самое для Часов...\n    if (minutes > 59) {\n        minutes = 0;\n        hours+=1;\n    emitValue<output_HOUR>(ctx, hours);\n    }\n    // ... и обнуляем счетчик Часов в конце дня\n    if (hours > 23) {\n        hours = 0;\n    }\n    state->nextTrig = tNext;\n    //пауза на 1 сек\n    setTimeout(ctx, 1000);\n    emitValue<output_SEC>(ctx, seconds);\n    }\n}\n",
          "encoding": "utf-8",
          "filename": "patch.cpp"
        }
      ],
      "nodes": {
        "H1avJ67wL": {
          "description": "Hours value in range [0, 23]",
          "id": "H1avJ67wL",
          "label": "HOUR",
          "position": {
            "x": 1,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "SyeHypmPL": {
          "id": "SyeHypmPL",
          "position": {
            "x": 2,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "SymvJamwU": {
          "description": "Minutes value in range [0, 59]",
          "id": "SymvJamwU",
          "label": "MIN",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "rJdLkaXv8": {
          "description": "Seconds value in range [0, 59]",
          "id": "rJdLkaXv8",
          "label": "SEC",
          "position": {
            "x": 3,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        }
      },
      "path": "@/program-clock"
    }
  }
}
