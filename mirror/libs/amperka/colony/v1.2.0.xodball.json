{
  "description": "Amperka/Colony set specific library",
  "license": "AGPL-3",
  "name": "colony",
  "patches": {
    "@/alarm-sound": {
      "comments": {
        "BJ9vYzSyr": {
          "content": "Computing tones' switch frequency",
          "id": "BJ9vYzSyr",
          "position": {
            "x": 7,
            "y": 2,
            "units": "slots"
          },
          "size": {
            "height": 1,
            "width": 4,
            "units": "slots"
          }
        },
        "BkeoFzryH": {
          "content": "Computing actual duration of each tone",
          "id": "BkeoFzryH",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          },
          "size": {
            "height": 1,
            "width": 4,
            "units": "slots"
          }
        }
      },
      "description": "Two tone alarm node",
      "links": {
        "B1KYSr4_v": {
          "id": "B1KYSr4_v",
          "input": {
            "nodeId": "SkouBrE_w",
            "pinKey": "Sy4Yi6a4pI"
          },
          "output": {
            "nodeId": "S1-QABeg1S",
            "pinKey": "__out__"
          }
        },
        "B1PMUgekB": {
          "id": "B1PMUgekB",
          "input": {
            "nodeId": "HkWOrxxJH",
            "pinKey": "r1-7S5HaAN"
          },
          "output": {
            "nodeId": "SJje7N60N",
            "pinKey": "__out__"
          }
        },
        "BJ3IwxlyS": {
          "id": "BJ3IwxlyS",
          "input": {
            "nodeId": "By9SDexyS",
            "pinKey": "SJ4zUC_BD1-"
          },
          "output": {
            "nodeId": "S1-QABeg1S",
            "pinKey": "__out__"
          }
        },
        "Bk2QIxekH": {
          "id": "Bk2QIxekH",
          "input": {
            "nodeId": "HkWOrxxJH",
            "pinKey": "ry7ScSaRV"
          },
          "output": {
            "nodeId": "SyVWUgeJH",
            "pinKey": "r1if8ROSDJ-"
          }
        },
        "BkNYBr4OP": {
          "id": "BkNYBr4OP",
          "input": {
            "nodeId": "SkouBrE_w",
            "pinKey": "rkKiaaETU"
          },
          "output": {
            "nodeId": "rymAHxgkH",
            "pinKey": "__out__"
          }
        },
        "BkpYBrVuD": {
          "id": "BkpYBrVuD",
          "input": {
            "nodeId": "SkouBrE_w",
            "pinKey": "BkHYoTT4TI"
          },
          "output": {
            "nodeId": "SJgmABggkS",
            "pinKey": "BJxRgAO8-"
          }
        },
        "BkvQCreeJS": {
          "id": "BkvQCreeJS",
          "input": {
            "nodeId": "SJgmABggkS",
            "pinKey": "H1v3lCu8-"
          },
          "output": {
            "nodeId": "By7XCrel1S",
            "pinKey": "__out__"
          }
        },
        "HJs5HBNdw": {
          "id": "HJs5HBNdw",
          "input": {
            "nodeId": "S1owBxlkS",
            "pinKey": "ry7ScSaRV"
          },
          "output": {
            "nodeId": "SkouBrE_w",
            "pinKey": "SJfYoapVaU"
          }
        },
        "Hk7H8eeJB": {
          "id": "Hk7H8eeJB",
          "input": {
            "nodeId": "HkWOrxxJH",
            "pinKey": "Sye7H9raCE"
          },
          "output": {
            "nodeId": "SJoBpXT0N",
            "pinKey": "__out__"
          }
        },
        "HkL8Pxe1r": {
          "id": "HkL8Pxe1r",
          "input": {
            "nodeId": "By9SDexyS",
            "pinKey": "B1GfLR_SPk-"
          },
          "output": {
            "nodeId": "rymAHxgkH",
            "pinKey": "__out__"
          }
        },
        "SyqDPex1r": {
          "id": "SyqDPex1r",
          "input": {
            "nodeId": "S1owBxlkS",
            "pinKey": "rJcPqBaC4"
          },
          "output": {
            "nodeId": "By9SDexyS",
            "pinKey": "BkQzLCurwJZ"
          }
        },
        "r1dKDleJS": {
          "id": "r1dKDleJS",
          "input": {
            "nodeId": "S17tDlxkH",
            "pinKey": "rkJ4URuHDJ-"
          },
          "output": {
            "nodeId": "By9SDexyS",
            "pinKey": "BkQzLCurwJZ"
          }
        },
        "rJoYBS4_P": {
          "id": "rJoYBS4_P",
          "input": {
            "nodeId": "SkouBrE_w",
            "pinKey": "HJxKop6EaL"
          },
          "output": {
            "nodeId": "By7XCrel1S",
            "pinKey": "__out__"
          }
        },
        "rk5G8xeJB": {
          "id": "rk5G8xeJB",
          "input": {
            "nodeId": "S1owBxlkS",
            "pinKey": "r1-7S5HaAN"
          },
          "output": {
            "nodeId": "ryOxQEp0E",
            "pinKey": "__out__"
          }
        },
        "rkjFwxxJB": {
          "id": "rkjFwxxJB",
          "input": {
            "nodeId": "S17tDlxkH",
            "pinKey": "BypX80uSD1Z"
          },
          "output": {
            "nodeId": "rymAHxgkH",
            "pinKey": "__out__"
          }
        },
        "rkxHLglkr": {
          "id": "rkxHLglkr",
          "input": {
            "nodeId": "S1owBxlkS",
            "pinKey": "Sye7H9raCE"
          },
          "output": {
            "nodeId": "SJoBpXT0N",
            "pinKey": "__out__"
          }
        },
        "ryKqBrV_v": {
          "id": "ryKqBrV_v",
          "input": {
            "nodeId": "SyVWUgeJH",
            "pinKey": "ry3zLA_Bv1Z"
          },
          "output": {
            "nodeId": "SkouBrE_w",
            "pinKey": "SJfYoapVaU"
          }
        },
        "ryRFveekr": {
          "id": "ryRFveekr",
          "input": {
            "nodeId": "HkWOrxxJH",
            "pinKey": "rJcPqBaC4"
          },
          "output": {
            "nodeId": "S17tDlxkH",
            "pinKey": "HyRmUCdBDkZ"
          }
        }
      },
      "nodes": {
        "By7XCrel1S": {
          "boundLiterals": {
            "__out__": "True"
          },
          "id": "By7XCrel1S",
          "label": "EN",
          "position": {
            "x": 11,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-boolean"
        },
        "By9SDexyS": {
          "id": "By9SDexyS",
          "position": {
            "x": 2,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/core/multiply"
        },
        "HkWOrxxJH": {
          "id": "HkWOrxxJH",
          "position": {
            "x": 8,
            "y": 5,
            "units": "slots"
          },
          "type": "@/play-note"
        },
        "S1-QABeg1S": {
          "boundLiterals": {
            "__out__": "0.5"
          },
          "description": "Defines tone 1 duration in fraction of T pin value",
          "id": "S1-QABeg1S",
          "label": "DUTY",
          "position": {
            "x": 9,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-number"
        },
        "S17tDlxkH": {
          "id": "S17tDlxkH",
          "position": {
            "x": 4,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/core/subtract"
        },
        "S1owBxlkS": {
          "id": "S1owBxlkS",
          "position": {
            "x": 1,
            "y": 5,
            "units": "slots"
          },
          "type": "@/play-note"
        },
        "SJgmABggkS": {
          "id": "SJgmABggkS",
          "position": {
            "x": 11,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/core/pulse-on-false"
        },
        "SJje7N60N": {
          "boundLiterals": {
            "__out__": "660"
          },
          "description": "Tone 2  frequency [Hz]",
          "id": "SJje7N60N",
          "label": "FRQ2",
          "position": {
            "x": 5,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-number"
        },
        "SJoBpXT0N": {
          "id": "SJoBpXT0N",
          "label": "PIN",
          "position": {
            "x": 1,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-port"
        },
        "SkouBrE_w": {
          "id": "SkouBrE_w",
          "position": {
            "x": 7,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/waves/square-wave"
        },
        "SyVWUgeJH": {
          "id": "SyVWUgeJH",
          "position": {
            "x": 11,
            "y": 4,
            "units": "slots"
          },
          "type": "xod/core/not"
        },
        "ryOxQEp0E": {
          "boundLiterals": {
            "__out__": "440"
          },
          "description": "Tone 1 frequency [Hz]",
          "id": "ryOxQEp0E",
          "label": "FRQ1",
          "position": {
            "x": 3,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-number"
        },
        "rymAHxgkH": {
          "boundLiterals": {
            "__out__": "1"
          },
          "description": "Defines the period of one complete cycle",
          "id": "rymAHxgkH",
          "label": "T",
          "position": {
            "x": 7,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-number"
        }
      },
      "path": "@/alarm-sound"
    },
    "@/lcd-melt-rus": {
      "attachments": [
        {
          "content": "\n#include <Wire.h>\n#include <LiquidCrystal_I2C.h>\n\nnodespace {\n    // cyrillic substitution codes from 1st font page\n    const unsigned char partd0[] = {\n        0x41,0xa0,0x42,0xa1,0xe0,0x45,0xa3,0xa4,0xa5,0xa6,0x4b,0xa7,0x4d,0x48,0x4f,0xa8,\n        0x50,0x43,0x54,0xa9,0xaa,0x58,0xe1,0xab,0xac,0xe2,0xad,0xae,0x62,0xaf,0xb0,0xb1,\n        0x61,0xb2,0xb3,0xb4,0xe3,0x65,0xb6,0xb7,0xb8,0xb9,0xba,0xbb,0xbc,0xbd,0x6f,0xbe\n    };\n    const unsigned char partd1[] = {\n        0x70,0x63,0xbf,0x79,0xe4,0x78,0xe5,0xc0,0xc1,0xe6,0xc2,0xc3,0xc4,0xc5,0xc6,0xc7\n    };\n\n    void printLine(LiquidCrystal_I2C* lcd, uint8_t lineIndex, XString str) {\n        unsigned char prefix = 0x00;\n        unsigned char current = 0x00;\n        lcd->setCursor(0, lineIndex);\n        uint8_t whitespace = 16;\n        for (auto it = str->iterate(); it; ++it) {\n            current = *it;\n            switch(current) {\n                // utf8 prefixes\n                case 0xd0: /* break; - realy not needed here */\n                case 0xd1: prefix = current; break;\n                default:\n                    // other codes\n                    switch(prefix) {\n                        case 0xd0:\n                            if(current == 0x81) {\n                                lcd->write(0xa2); // Ё\n                            } else {\n                                if(current >= 0x90 && current <= 0xbf) { // А-Яа-п\n                                    lcd->write(partd0[current - 0x90]);\n                                } else {\n                                    lcd->write(current);\n                                }\n                            }\n                            break;\n                        case 0xd1:\n                            if(current == 0x91) {\n                                lcd->write(0xb5); // ё\n                            } else {\n                                if(current >= 0x80 && current <= 0x8f) { // р-я\n                                    lcd->write(partd1[current - 0x80]);\n                                } else {\n                                    lcd->write(current);\n                                }\n                            }\n                            break;\n                        case 0x00:\n                            lcd->write(current); // non cyrillic\n                            break;\n                    }\n                    whitespace--;\n                    prefix = 0x00;\n                    break;\n            }\n        }\n\n        // Clear the rest of the line\n        while (whitespace--)\n            lcd->write(' ');\n    }\n}\n\nnode {\n    LiquidCrystal_I2C* lcd;\n\n    void evaluate(Context ctx) {\n        if (!isInputDirty<input_UPD>(ctx))\n            return;\n\n        if (!lcd) {\n            uint8_t addr = getValue<input_ADDR>(ctx);\n            lcd = new LiquidCrystal_I2C(addr, 16, 2);\n            lcd->begin();\n        }\n\n        printLine(lcd, 0, getValue<input_L1>(ctx));\n        printLine(lcd, 1, getValue<input_L2>(ctx));\n        lcd->setBacklight(getValue<input_BL>(ctx));\n        emitValue<output_DONE>(ctx, 1);\n    }\n}\n",
          "encoding": "utf8",
          "filename": "patch.cpp"
        }
      ],
      "description": "i2c MT-16S2H-8 liquid crystal driver with utf8 to cyrillic convertor. Uses 1st font page. ",
      "nodes": {
        "Bk7Lomm6CN": {
          "id": "Bk7Lomm6CN",
          "label": "LCD_MELT_RUS",
          "position": {
            "x": 2,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "BkWLsmmTCV": {
          "description": "Fires when write is done",
          "id": "BkWLsmmTCV",
          "label": "DONE",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "Bkz8jQXp04": {
          "boundLiterals": {
            "__out__": "Continuously"
          },
          "id": "Bkz8jQXp04",
          "label": "UPD",
          "position": {
            "x": 9,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "HkgIsmmaRV": {
          "description": "Text for the second line",
          "id": "HkgIsmmaRV",
          "label": "L2",
          "position": {
            "x": 7,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-string"
        },
        "SJVLsmmTRE": {
          "boundLiterals": {
            "__out__": "True"
          },
          "description": "Backlight enable/disable",
          "id": "SJVLsmmTRE",
          "label": "BL",
          "position": {
            "x": 4,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-boolean"
        },
        "r1HUjXXaCN": {
          "boundLiterals": {
            "__out__": "38h"
          },
          "description": "I²C address of expander chip",
          "id": "r1HUjXXaCN",
          "label": "ADDR",
          "position": {
            "x": 2,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-byte"
        },
        "rkUoQ7aAV": {
          "description": "Text for the first line",
          "id": "rkUoQ7aAV",
          "label": "L1",
          "position": {
            "x": 6,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-string"
        }
      },
      "path": "@/lcd-melt-rus"
    },
    "@/max-value": {
      "comments": {
        "rJth2-r1S": {
          "content": "For STP value lower then 30, IVAL pin value higher then 0.2 is recommended. For 30 steps and higher, IVAL may be lower. Lowest IVAL value is defined by servo features.",
          "id": "rJth2-r1S",
          "position": {
            "x": 3,
            "y": -5,
            "units": "slots"
          },
          "size": {
            "height": 2,
            "width": 4,
            "units": "slots"
          }
        }
      },
      "description": "Node for Amperka \"Colony kit\". May be used for scanning for maximum value via analog sensor attached to a servo. Spins servo from 0° to 180°, gets maximum value of analog data and then spins servo to the angle where the max value was.",
      "links": {
        "B14eCVWJB": {
          "id": "B14eCVWJB",
          "input": {
            "nodeId": "ByUfYNZ1r",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "r1CIFEZkr",
            "pinKey": "__out__"
          }
        },
        "B1P-w4byS": {
          "id": "B1P-w4byS",
          "input": {
            "nodeId": "rJVZw4WJB",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "SyM1TM-1H",
            "pinKey": "S1K8wUY9b"
          }
        },
        "B1Qni_e_v": {
          "id": "B1Qni_e_v",
          "input": {
            "nodeId": "Hy_jYOl_w",
            "pinKey": "Hk3C__e_v"
          },
          "output": {
            "nodeId": "HkybtfWyB",
            "pinKey": "HJU8CE2lW"
          }
        },
        "BJqjKOg_D": {
          "id": "BJqjKOg_D",
          "input": {
            "nodeId": "Hy_jYOl_w",
            "pinKey": "BJ22ddluv"
          },
          "output": {
            "nodeId": "BktoImTRV",
            "pinKey": "__out__"
          }
        },
        "BkEcH3_xOv": {
          "id": "BkEcH3_xOv",
          "input": {
            "nodeId": "r1LVszW1B",
            "pinKey": "B1RU0OrDkb"
          },
          "output": {
            "nodeId": "HyX5BndxOw",
            "pinKey": "__out__"
          }
        },
        "BkHQpFlOw": {
          "id": "BkHQpFlOw",
          "input": {
            "nodeId": "SylX6Fedw",
            "pinKey": "ryv7IRdSP1b"
          },
          "output": {
            "nodeId": "B1qfRV-1r",
            "pinKey": "ByHmL0uHPk-"
          }
        },
        "BkkLifWJS": {
          "id": "BkkLifWJS",
          "input": {
            "nodeId": "HkybtfWyB",
            "pinKey": "r1jzp_DTZ"
          },
          "output": {
            "nodeId": "r1LVszW1B",
            "pinKey": "HkyxURuSPyW"
          }
        },
        "ByQ4hOldv": {
          "id": "ByQ4hOldv",
          "input": {
            "nodeId": "Sk5TBM-JS",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "Hy_jYOl_w",
            "pinKey": "HJx9WKuxdD"
          }
        },
        "H1DQ6KxOw": {
          "id": "H1DQ6KxOw",
          "input": {
            "nodeId": "SylX6Fedw",
            "pinKey": "ByU7LRuSPkW"
          },
          "output": {
            "nodeId": "SyM1TM-1H",
            "pinKey": "S1K8wUY9b"
          }
        },
        "HJODKV-JB": {
          "id": "HJODKV-JB",
          "input": {
            "nodeId": "S19JKNbJS",
            "pinKey": "H1v3lCu8-"
          },
          "output": {
            "nodeId": "r1CIFEZkr",
            "pinKey": "__out__"
          }
        },
        "S1nCSrb1B": {
          "id": "S1nCSrb1B",
          "input": {
            "nodeId": "rJWhHB-1B",
            "pinKey": "BytUCdHD1-"
          },
          "output": {
            "nodeId": "ByPn8ma0E",
            "pinKey": "__out__"
          }
        },
        "SkH4hug_v": {
          "id": "SkH4hug_v",
          "input": {
            "nodeId": "HyqqDXaC4",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "Hy_jYOl_w",
            "pinKey": "S1qWtul_v"
          }
        },
        "Sy390VWJr": {
          "id": "Sy390VWJr",
          "input": {
            "nodeId": "B1qfRV-1r",
            "pinKey": "ryv7IRdSP1b"
          },
          "output": {
            "nodeId": "ByUfYNZ1r",
            "pinKey": "__out__"
          }
        },
        "SyMX6tlOv": {
          "id": "SyMX6tlOv",
          "input": {
            "nodeId": "HJqShOlOw",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "SylX6Fedw",
            "pinKey": "ByHmL0uHPk-"
          }
        },
        "Syf5HnulOw": {
          "id": "Syf5HnulOw",
          "input": {
            "nodeId": "HkybtfWyB",
            "pinKey": "BJJICN2lW"
          },
          "output": {
            "nodeId": "ry-5rnuluP",
            "pinKey": "__out__"
          }
        },
        "r1vpoux_D": {
          "id": "r1vpoux_D",
          "input": {
            "nodeId": "SyM1TM-1H",
            "pinKey": "Hk-UvIK9b"
          },
          "output": {
            "nodeId": "Hy_jYOl_w",
            "pinKey": "BJeeK_x_D"
          }
        },
        "rJbE0EbJr": {
          "id": "rJbE0EbJr",
          "input": {
            "nodeId": "B1qfRV-1r",
            "pinKey": "ByU7LRuSPkW"
          },
          "output": {
            "nodeId": "ry_t64WyS",
            "pinKey": "ryVmUAOrvkb"
          }
        },
        "rJpJnueOw": {
          "id": "rJpJnueOw",
          "input": {
            "nodeId": "r1LVszW1B",
            "pinKey": "Bkh8A_Sv1-"
          },
          "output": {
            "nodeId": "S19JKNbJS",
            "pinKey": "BJxRgAO8-"
          }
        },
        "rkPfaKgOw": {
          "id": "rkPfaKgOw",
          "input": {
            "nodeId": "Hy_jYOl_w",
            "pinKey": "HkJn__edv"
          },
          "output": {
            "nodeId": "B1qfRV-1r",
            "pinKey": "ByHmL0uHPk-"
          }
        },
        "rkco5dedw": {
          "id": "rkco5dedw",
          "input": {
            "nodeId": "Hy_jYOl_w",
            "pinKey": "HJX0udx_D"
          },
          "output": {
            "nodeId": "rJWhHB-1B",
            "pinKey": "BkqLCOSw1W"
          }
        }
      },
      "nodes": {
        "B1qfRV-1r": {
          "id": "B1qfRV-1r",
          "position": {
            "x": 13,
            "y": -3,
            "units": "slots"
          },
          "type": "xod/core/any"
        },
        "BktoImTRV": {
          "description": "Analog sensor data value [0...1.0]",
          "id": "BktoImTRV",
          "label": "VAL",
          "position": {
            "x": 6,
            "y": -6,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-number"
        },
        "ByPn8ma0E": {
          "description": "Search step quantity [2...180]. Degrees of each step = 180 / STP",
          "id": "ByPn8ma0E",
          "label": "STP",
          "position": {
            "x": 8,
            "y": -6,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-number"
        },
        "ByUfYNZ1r": {
          "id": "ByUfYNZ1r",
          "position": {
            "x": 13,
            "y": -4,
            "units": "slots"
          },
          "type": "xod/core/pulse-on-true"
        },
        "HJqShOlOw": {
          "id": "HJqShOlOw",
          "label": "RST",
          "position": {
            "x": 15,
            "y": -2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/to-bus"
        },
        "HkybtfWyB": {
          "boundLiterals": {
            "B13SCNhl-": "0.2",
            "BJJICN2lW": "On Boot"
          },
          "id": "HkybtfWyB",
          "position": {
            "x": 9,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/core/clock"
        },
        "HyX5BndxOw": {
          "id": "HyX5BndxOw",
          "label": "RST",
          "position": {
            "x": 11,
            "y": -2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/from-bus"
        },
        "Hy_jYOl_w": {
          "id": "Hy_jYOl_w",
          "position": {
            "x": 6,
            "y": 3,
            "units": "slots"
          },
          "type": "@/max-value-internal"
        },
        "HyqqDXaC4": {
          "description": "Current servo angle [0...1.0]",
          "id": "HyqqDXaC4",
          "label": "ANG",
          "position": {
            "x": 7,
            "y": 5,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "S19JKNbJS": {
          "id": "S19JKNbJS",
          "position": {
            "x": 9,
            "y": -4,
            "units": "slots"
          },
          "type": "xod/core/pulse-on-false"
        },
        "Sk5TBM-JS": {
          "description": "Found maximum angle value stored in memory [0...180]",
          "id": "Sk5TBM-JS",
          "label": "MEM",
          "position": {
            "x": 6,
            "y": 5,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "SyM1TM-1H": {
          "id": "SyM1TM-1H",
          "position": {
            "x": 19,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/core/defer(pulse)"
        },
        "SylX6Fedw": {
          "id": "SylX6Fedw",
          "position": {
            "x": 15,
            "y": -3,
            "units": "slots"
          },
          "type": "xod/core/any"
        },
        "r1CIFEZkr": {
          "id": "r1CIFEZkr",
          "label": "EN",
          "position": {
            "x": 11,
            "y": -6,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-boolean"
        },
        "r1LVszW1B": {
          "boundLiterals": {
            "B1RU0OrDkb": "On Boot"
          },
          "id": "r1LVszW1B",
          "position": {
            "x": 9,
            "y": -1,
            "units": "slots"
          },
          "type": "xod/core/flip-flop"
        },
        "rJVZw4WJB": {
          "description": "Fires when done",
          "id": "rJVZw4WJB",
          "label": "DONE",
          "position": {
            "x": 19,
            "y": 5,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "rJWhHB-1B": {
          "boundLiterals": {
            "SkdIRuBD1b": "180"
          },
          "id": "rJWhHB-1B",
          "position": {
            "x": 7,
            "y": -5,
            "units": "slots"
          },
          "type": "xod/core/divide"
        },
        "ry-5rnuluP": {
          "id": "ry-5rnuluP",
          "label": "RST",
          "position": {
            "x": 11,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/from-bus"
        },
        "ry_t64WyS": {
          "id": "ry_t64WyS",
          "position": {
            "x": 14,
            "y": -4,
            "units": "slots"
          },
          "type": "xod/core/boot"
        }
      },
      "path": "@/max-value"
    },
    "@/max-value-internal": {
      "attachments": [
        {
          "content": "\nnode {\n    Number maxValue = 0;\n\n    void evaluate(Context ctx) {\n        if (isInputDirty<input_RST>(ctx)) {\n            maxValue = 0;\n            emitValue<output_CUR>(ctx, 0);\n            emitValue<output_MAX>(ctx, 0);\n        }\n\n        if (isInputDirty<input_NEXT>(ctx)) {\n            auto step = getValue<input_STP>(ctx);\n            auto currentAngle = getValue<output_CUR>(ctx);\n            auto nextAngle = currentAngle + step;\n\n            if (nextAngle > 180) {\n                emitValue<output_DONE>(ctx, 1);\n                emitValue<output_CUR>(ctx, getValue<output_MAX>(ctx));\n            } else {\n                auto currentValue = getValue<input_VAL>(ctx);\n                if (currentValue > maxValue) {\n                    maxValue = currentValue;\n                    emitValue<output_MAX>(ctx, currentAngle);\n                }\n\n                emitValue<output_CUR>(ctx, nextAngle);\n            }\n        }\n    }\n}\n",
          "encoding": "utf8",
          "filename": "patch.cpp"
        }
      ],
      "nodes": {
        "BJ22ddluv": {
          "id": "BJ22ddluv",
          "label": "VAL",
          "position": {
            "x": 1,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-number"
        },
        "BJeeK_x_D": {
          "id": "BJeeK_x_D",
          "label": "DONE",
          "position": {
            "x": 5,
            "y": 4,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "HJX0udx_D": {
          "id": "HJX0udx_D",
          "label": "STP",
          "position": {
            "x": 3,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-number"
        },
        "HJx9WKuxdD": {
          "id": "HJx9WKuxdD",
          "label": "MAX",
          "position": {
            "x": 1,
            "y": 4,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "Hk3C__e_v": {
          "id": "Hk3C__e_v",
          "label": "NEXT",
          "position": {
            "x": 7,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "HkJn__edv": {
          "id": "HkJn__edv",
          "label": "RST",
          "position": {
            "x": 5,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "S1qWtul_v": {
          "description": "Current servo angle\n",
          "id": "S1qWtul_v",
          "label": "CUR",
          "position": {
            "x": 3,
            "y": 4,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-number"
        },
        "rknvFOg_v": {
          "id": "rknvFOg_v",
          "position": {
            "x": 1,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "rysc__guv": {
          "id": "rysc__guv",
          "position": {
            "x": 11,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/utility"
        }
      },
      "path": "@/max-value-internal"
    },
    "@/max-value-test": {
      "description": "max-value using test configuration",
      "links": {
        "BkfBUzZyr": {
          "id": "BkfBUzZyr",
          "input": {
            "nodeId": "r1z9VrG-Jr",
            "pinKey": "BktoImTRV"
          },
          "output": {
            "nodeId": "BySqESGZkH",
            "pinKey": "H12bIR_SPyZ"
          }
        },
        "ByPuoEW1H": {
          "id": "ByPuoEW1H",
          "input": {
            "nodeId": "SybujNbkS",
            "pinKey": "BJlzICOSv1-"
          },
          "output": {
            "nodeId": "r1z9VrG-Jr",
            "pinKey": "HyqqDXaC4"
          }
        },
        "SyduiE-JH": {
          "id": "SyduiE-JH",
          "input": {
            "nodeId": "Sy5VBzWJS",
            "pinKey": "Bk5lexBtE"
          },
          "output": {
            "nodeId": "SybujNbkS",
            "pinKey": "H12bIR_SPyZ"
          }
        },
        "rkq94SfZJH": {
          "id": "rkq94SfZJH",
          "input": {
            "nodeId": "BySqESGZkH",
            "pinKey": "BJlzICOSv1-"
          },
          "output": {
            "nodeId": "H1N94rMZyH",
            "pinKey": "BkoeN9Ay7"
          }
        },
        "rym6tEb1H": {
          "id": "rym6tEb1H",
          "input": {
            "nodeId": "r1z9VrG-Jr",
            "pinKey": "r1CIFEZkr"
          },
          "output": {
            "nodeId": "B1xq4rz-yr",
            "pinKey": "BJ--G1tI-"
          }
        }
      },
      "nodes": {
        "B1xq4rz-yr": {
          "boundLiterals": {
            "ByNiWkt8Z": "D0"
          },
          "id": "B1xq4rz-yr",
          "position": {
            "x": 6,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/common-hardware/button"
        },
        "BySqESGZkH": {
          "boundLiterals": {
            "HJCWLAdSwyW": "1",
            "rJbGU0_Hv1Z": "1"
          },
          "id": "BySqESGZkH",
          "position": {
            "x": 0,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/math/map"
        },
        "H1N94rMZyH": {
          "boundLiterals": {
            "r1l3XcR17": "A0"
          },
          "id": "H1N94rMZyH",
          "position": {
            "x": 0,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/common-hardware/analog-sensor"
        },
        "Sy5VBzWJS": {
          "boundLiterals": {
            "BkXK1eBYV": "D1"
          },
          "id": "Sy5VBzWJS",
          "position": {
            "x": 2,
            "y": 4,
            "units": "slots"
          },
          "type": "xod-dev/servo/servo"
        },
        "SybujNbkS": {
          "boundLiterals": {
            "HJCWLAdSwyW": "180",
            "rkpbU0OrwyZ": "1"
          },
          "id": "SybujNbkS",
          "position": {
            "x": 3,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/math/map"
        },
        "r1z9VrG-Jr": {
          "boundLiterals": {
            "B15XXtrLV": "12",
            "ByPn8ma0E": "12"
          },
          "id": "r1z9VrG-Jr",
          "position": {
            "x": 2,
            "y": 2,
            "units": "slots"
          },
          "type": "@/max-value"
        }
      },
      "path": "@/max-value-test"
    },
    "@/play-note": {
      "attachments": [
        {
          "content": "\nstruct State {\n};\n\n{{ GENERATED_CODE }}\n\nvoid evaluate(Context ctx) {\n    if (!isInputDirty<input_UPD>(ctx)) return;\n    \n    auto pin = getValue<input_PIN>(ctx);\n    auto frequency = getValue<input_FREQ>(ctx);\n    auto duration = getValue<input_DUR>(ctx);\n    \n    tone(pin, frequency);\n    delay(duration*1000);\n    noTone(pin);\n}\n",
          "encoding": "utf8",
          "filename": "patch.cpp"
        }
      ],
      "comments": {
        "S1eC2RNkr": {
          "content": "Использует tone(), noTone() и delay()",
          "id": "S1eC2RNkr",
          "position": {
            "x": 4,
            "y": 1,
            "units": "slots"
          },
          "size": {
            "height": 1,
            "width": 7,
            "units": "slots"
          }
        }
      },
      "description": "Play one note with frequency [Hz] and fixed duration [s]",
      "nodes": {
        "BkGQrcHp0E": {
          "id": "BkGQrcHp0E",
          "label": "Note player",
          "position": {
            "x": 2,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "Sye7H9raCE": {
          "boundLiterals": {
            "__out__": "D0"
          },
          "id": "Sye7H9raCE",
          "label": "PIN",
          "position": {
            "x": 0,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-port"
        },
        "r1-7S5HaAN": {
          "boundLiterals": {
            "__out__": "440"
          },
          "description": "Sound frequency [Hz]",
          "id": "r1-7S5HaAN",
          "label": "FREQ",
          "position": {
            "x": 2,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-number"
        },
        "rJcPqBaC4": {
          "boundLiterals": {
            "__out__": "0.25"
          },
          "description": "Sound duration [s]",
          "id": "rJcPqBaC4",
          "label": "DUR",
          "position": {
            "x": 4,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-number"
        },
        "ry7ScSaRV": {
          "id": "ry7ScSaRV",
          "label": "UPD",
          "position": {
            "x": 6,
            "y": 0,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        }
      },
      "path": "@/play-note"
    },
    "@/rtttl-player": {
      "attachments": [
        {
          "content": "#pragma XOD require \"https://github.com/end2endzone/AnyRtttl\"\n\n{{#global}}\n#include <anyrtttl.h>\n#include <binrtttl.h>\n#include <pitches.h>\n{{/global}}\n\nstruct State {\n    char* notearray;\n};\n\n{{ GENERATED_CODE }}\n\nvoid evaluate(Context ctx) {\n    XString rtttlString = getValue<input_RTTTL>(ctx);\n    auto buzzerPin = getValue<input_PIN>(ctx);\n    State* state = getState(ctx);\n    \n    if (isInputDirty<input_EN>(ctx)) {\n        // if \"enable\" play string\n        anyrtttl::blocking::play(buzzerPin, state->notearray);\n        emitValue<output_DONE>(ctx, true);\n    } else {\n        // else update string\n        if(state->notearray != nullptr) { delete state->notearray; }\n        auto len = length(rtttlString);\n        state->notearray = new char[len + 1];\n        dump(rtttlString,state->notearray);\n    }\n}\n",
          "encoding": "utf8",
          "filename": "patch.cpp"
        }
      ],
      "description": "RTTTL format sound player module. See RTTTL data format at: https://en.wikipedia.org/wiki/Ring_Tone_Transfer_Language",
      "nodes": {
        "BJjoT0JJH": {
          "boundLiterals": {
            "__out__": "D0"
          },
          "id": "BJjoT0JJH",
          "label": "PIN",
          "position": {
            "x": 5,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-port"
        },
        "HJ0vqRJkr": {
          "id": "HJ0vqRJkr",
          "label": "RTTTL player",
          "position": {
            "x": 7,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/patch-nodes/not-implemented-in-xod"
        },
        "HyTLckeyr": {
          "id": "HyTLckeyr",
          "label": "EN",
          "position": {
            "x": 9,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-pulse"
        },
        "r14OETOkS": {
          "description": "Fires when done",
          "id": "r14OETOkS",
          "label": "DONE",
          "position": {
            "x": 7,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/patch-nodes/output-pulse"
        },
        "r1ud9011B": {
          "description": "String of RTTTL data of melody",
          "id": "r1ud9011B",
          "label": "RTTTL",
          "position": {
            "x": 7,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-string"
        }
      },
      "path": "@/rtttl-player"
    },
    "@/x": {
      "description": "X theme  node",
      "links": {
        "BykSHauJH": {
          "id": "BykSHauJH",
          "input": {
            "nodeId": "S1n5aye1B",
            "pinKey": "HyTLckeyr"
          },
          "output": {
            "nodeId": "HkqbSTdJB",
            "pinKey": "ByHmL0uHPk-"
          }
        },
        "H1LeC1gkr": {
          "id": "H1LeC1gkr",
          "input": {
            "nodeId": "S1n5aye1B",
            "pinKey": "BJjoT0JJH"
          },
          "output": {
            "nodeId": "Byl10JekH",
            "pinKey": "__out__"
          }
        },
        "H1aJ_p_yS": {
          "id": "H1aJ_p_yS",
          "input": {
            "nodeId": "HkqbSTdJB",
            "pinKey": "ByU7LRuSPkW"
          },
          "output": {
            "nodeId": "HyNo8p_1r",
            "pinKey": "S1K8wUY9b"
          }
        },
        "S1dtbxg1B": {
          "id": "S1dtbxg1B",
          "input": {
            "nodeId": "rJquWxxyS",
            "pinKey": "__in__"
          },
          "output": {
            "nodeId": "BJ8K-eekH",
            "pinKey": "__out__"
          }
        },
        "r1MhLpdkB": {
          "id": "r1MhLpdkB",
          "input": {
            "nodeId": "HyNo8p_1r",
            "pinKey": "Hk-UvIK9b"
          },
          "output": {
            "nodeId": "S1n5aye1B",
            "pinKey": "r14OETOkS"
          }
        },
        "rJgfBaOkB": {
          "id": "rJgfBaOkB",
          "input": {
            "nodeId": "HkqbSTdJB",
            "pinKey": "ryv7IRdSP1b"
          },
          "output": {
            "nodeId": "rJquWxxyS",
            "pinKey": "__out__"
          }
        }
      },
      "nodes": {
        "BJ8K-eekH": {
          "id": "BJ8K-eekH",
          "label": "EN",
          "position": {
            "x": 15,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-boolean"
        },
        "Byl10JekH": {
          "boundLiterals": {
            "__out__": "D0"
          },
          "id": "Byl10JekH",
          "label": "PIN",
          "position": {
            "x": 13,
            "y": 1,
            "units": "slots"
          },
          "type": "xod/patch-nodes/input-port"
        },
        "HkqbSTdJB": {
          "id": "HkqbSTdJB",
          "position": {
            "x": 15,
            "y": 3,
            "units": "slots"
          },
          "type": "xod/core/any"
        },
        "HyNo8p_1r": {
          "id": "HyNo8p_1r",
          "position": {
            "x": 16,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/core/defer(pulse)"
        },
        "S1n5aye1B": {
          "boundLiterals": {
            "HyTLckeyr": "On Boot",
            "r1ud9011B": "\"X:d=4,o=5,b=125:e,b,a,b,d6,2b.,p,e,b,a,b,e6,2b.,p,g6,f#6,e6,d6,e6,2b.,p,g6,f#6,e6,d6,f#6,2b.,2p\""
          },
          "id": "S1n5aye1B",
          "position": {
            "x": 13,
            "y": 4,
            "units": "slots"
          },
          "type": "@/rtttl-player"
        },
        "rJquWxxyS": {
          "id": "rJquWxxyS",
          "position": {
            "x": 15,
            "y": 2,
            "units": "slots"
          },
          "type": "xod/core/pulse-on-true"
        }
      },
      "path": "@/x"
    }
  },
  "version": "1.2.0"
}
